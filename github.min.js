"use strict";!function(e,t){"function"==typeof define&&define.amd?define(["es6-promise","base-64","utf8","axios"],function(n,o,s,i){return e.Github=t(n,o,s,i)}):"object"==typeof module&&module.exports?module.exports=t(require("es6-promise"),require("base-64"),require("utf8"),require("axios")):e.Github=t(e.Promise,e.base64,e.utf8,e.axios)}(this,function(e,t,n,o){function s(e){return t.encode(n.encode(e))}e.polyfill&&e.polyfill();var i=function(e){var t=e.apiUrl||"https://api.github.com",n=i._request=function(n,i,u,r,a){function c(){var e=i.indexOf("//")>=0?i:t+i;if(e+=/\?/.test(e)?"&":"?",u&&"object"==typeof u&&["GET","HEAD","DELETE"].indexOf(n)>-1)for(var o in u)u.hasOwnProperty(o)&&(e+="&"+encodeURIComponent(o)+"="+encodeURIComponent(u[o]));return e+("undefined"!=typeof window?"&"+(new Date).getTime():"")}var l={headers:{Accept:a?"application/vnd.github.v3.raw+json":"application/vnd.github.v3+json","Content-Type":"application/json;charset=UTF-8"},method:n,data:u?u:{},url:c()};return(e.token||e.username&&e.password)&&(l.headers.Authorization=e.token?"token "+e.token:"Basic "+s(e.username+":"+e.password)),o(l).then(function(e){r(null,e.data||!0,e.request)},function(e){304===e.status?r(null,e.data||!0,e.request):r({path:i,request:e.request,error:e.status})})},u=i._requestAllPages=function(e,t){var o=[];!function s(){n("GET",e,null,function(n,i,u){if(n)return t(n);i instanceof Array||(i=[i]),o.push.apply(o,i);var r=(u.getResponseHeader("link")||"").split(/\s*,\s*/g),a=null;r.forEach(function(e){a=/rel="next"/.test(e)?e:a}),a&&(a=(/<(.*)>/.exec(a)||[])[1]),a?(e=a,s()):t(n,o)})}()};return i.User=function(){this.repos=function(e,t){1===arguments.length&&"function"==typeof arguments[0]&&(t=e,e={}),e=e||{};var o="/user/repos",s=[];s.push("type="+encodeURIComponent(e.type||"all")),s.push("sort="+encodeURIComponent(e.sort||"updated")),s.push("per_page="+encodeURIComponent(e.per_page||"100")),e.page&&s.push("page="+encodeURIComponent(e.page)),o+="?"+s.join("&"),n("GET",o,null,t)},this.orgs=function(e){n("GET","/user/orgs",null,e)},this.gists=function(e){n("GET","/gists",null,e)},this.notifications=function(e,t){1===arguments.length&&"function"==typeof arguments[0]&&(t=e,e={}),e=e||{};var o="/notifications",s=[];if(e.all&&s.push("all=true"),e.participating&&s.push("participating=true"),e.since){var i=e.since;i.constructor===Date&&(i=i.toISOString()),s.push("since="+encodeURIComponent(i))}if(e.before){var u=e.before;u.constructor===Date&&(u=u.toISOString()),s.push("before="+encodeURIComponent(u))}e.page&&s.push("page="+encodeURIComponent(e.page)),s.length>0&&(o+="?"+s.join("&")),n("GET",o,null,t)},this.show=function(e,t){var o=e?"/users/"+e:"/user";n("GET",o,null,t)},this.userRepos=function(e,t){u("/users/"+e+"/repos?type=all&per_page=100&sort=updated",t)},this.userStarred=function(e,t){u("/users/"+e+"/starred?type=all&per_page=100",t)},this.userGists=function(e,t){n("GET","/users/"+e+"/gists",null,t)},this.orgRepos=function(e,t){u("/orgs/"+e+"/repos?type=all&&page_num=1000&sort=updated&direction=desc",t)},this.follow=function(e,t){n("PUT","/user/following/"+e,null,t)},this.unfollow=function(e,t){n("DELETE","/user/following/"+e,null,t)},this.createRepo=function(e,t){n("POST","/user/repos",e,t)}},i.Repository=function(e){function t(e,t){return e===l.branch&&l.sha?t(null,l.sha):void c.getRef("heads/"+e,function(n,o){l.branch=e,l.sha=o,t(n,o)})}var o,u=e.name,r=e.user,a=e.fullname,c=this;o=a?"/repos/"+a:"/repos/"+r+"/"+u;var l={branch:null,sha:null};this.getRef=function(e,t){n("GET",o+"/git/refs/"+e,null,function(e,n,o){return e?t(e):void t(null,n.object.sha,o)})},this.createRef=function(e,t){n("POST",o+"/git/refs",e,t)},this.deleteRef=function(t,s){n("DELETE",o+"/git/refs/"+t,e,s)},this.createRepo=function(e,t){n("POST","/user/repos",e,t)},this.deleteRepo=function(t){n("DELETE",o,e,t)},this.listTags=function(e){n("GET",o+"/tags",null,e)},this.listPulls=function(e,t){e=e||{};var s=o+"/pulls",i=[];"string"==typeof e?i.push("state="+e):(e.state&&i.push("state="+encodeURIComponent(e.state)),e.head&&i.push("head="+encodeURIComponent(e.head)),e.base&&i.push("base="+encodeURIComponent(e.base)),e.sort&&i.push("sort="+encodeURIComponent(e.sort)),e.direction&&i.push("direction="+encodeURIComponent(e.direction)),e.page&&i.push("page="+e.page),e.per_page&&i.push("per_page="+e.per_page)),i.length>0&&(s+="?"+i.join("&")),n("GET",s,null,t)},this.getPull=function(e,t){n("GET",o+"/pulls/"+e,null,t)},this.compare=function(e,t,s){n("GET",o+"/compare/"+e+"..."+t,null,s)},this.listBranches=function(e){n("GET",o+"/git/refs/heads",null,function(t,n,o){return t?e(t):void e(null,n.map(function(e){return e.ref.replace(/^refs\/heads\//,"")}),o)})},this.getBlob=function(e,t){n("GET",o+"/git/blobs/"+e,null,t,"raw")},this.getCommit=function(e,t,s){n("GET",o+"/git/commits/"+t,null,s)},this.getSha=function(e,t,s){return t&&""!==t?void n("GET",o+"/contents/"+t+(e?"?ref="+e:""),null,function(e,t,n){return e?s(e):void s(null,t.sha,n)}):c.getRef("heads/"+e,s)},this.getStatuses=function(e,t){n("GET",o+"/statuses/"+e,null,t)},this.getTree=function(e,t){n("GET",o+"/git/trees/"+e,null,function(e,n,o){return e?t(e):void t(null,n.tree,o)})},this.postBlob=function(e,t){e="string"==typeof e?{content:e,encoding:"utf-8"}:{content:s(e),encoding:"base64"},n("POST",o+"/git/blobs",e,function(e,n){return e?t(e):void t(null,n.sha)})},this.updateTree=function(e,t,s,i){var u={base_tree:e,tree:[{path:t,mode:"100644",type:"blob",sha:s}]};n("POST",o+"/git/trees",u,function(e,t){return e?i(e):void i(null,t.sha)})},this.postTree=function(e,t){n("POST",o+"/git/trees",{tree:e},function(e,n){return e?t(e):void t(null,n.sha)})},this.commit=function(t,s,u,r){var a=new i.User;a.show(null,function(i,a){if(i)return r(i);var c={message:u,author:{name:e.user,email:a.email},parents:[t],tree:s};n("POST",o+"/git/commits",c,function(e,t){return e?r(e):(l.sha=t.sha,void r(null,t.sha))})})},this.updateHead=function(e,t,s){n("PATCH",o+"/git/refs/heads/"+e,{sha:t},s)},this.show=function(e){n("GET",o,null,e)},this.contributors=function(e,t){t=t||1e3;var s=this;n("GET",o+"/stats/contributors",null,function(n,o,i){return n?e(n):void(202===i.status?setTimeout(function(){s.contributors(e,t)},t):e(n,o,i))})},this.contents=function(e,t,s){t=encodeURI(t),n("GET",o+"/contents"+(t?"/"+t:""),{ref:e},s)},this.fork=function(e){n("POST",o+"/forks",null,e)},this.listForks=function(e){n("GET",o+"/forks",null,e)},this.branch=function(e,t,n){2===arguments.length&&"function"==typeof arguments[1]&&(n=t,t=e,e="master"),this.getRef("heads/"+e,function(e,o){return e&&n?n(e):void c.createRef({ref:"refs/heads/"+t,sha:o},n)})},this.createPullRequest=function(e,t){n("POST",o+"/pulls",e,t)},this.listHooks=function(e){n("GET",o+"/hooks",null,e)},this.getHook=function(e,t){n("GET",o+"/hooks/"+e,null,t)},this.createHook=function(e,t){n("POST",o+"/hooks",e,t)},this.editHook=function(e,t,s){n("PATCH",o+"/hooks/"+e,t,s)},this.deleteHook=function(e,t){n("DELETE",o+"/hooks/"+e,null,t)},this.read=function(e,t,s){n("GET",o+"/contents/"+encodeURI(t)+(e?"?ref="+e:""),null,function(e,t,n){return e&&404===e.error?s("not found",null,null):e?s(e):void s(null,t,n)},!0)},this.remove=function(e,t,s){c.getSha(e,t,function(i,u){return i?s(i):void n("DELETE",o+"/contents/"+t,{message:t+" is removed",sha:u,branch:e},s)})},this["delete"]=this.remove,this.move=function(e,n,o,s){t(e,function(t,i){c.getTree(i+"?recursive=true",function(t,u){u.forEach(function(e){e.path===n&&(e.path=o),"tree"===e.type&&delete e.sha}),c.postTree(u,function(t,o){c.commit(i,o,"Deleted "+n,function(t,n){c.updateHead(e,n,s)})})})})},this.write=function(e,t,i,u,r,a){"undefined"==typeof a&&(a=r,r={}),c.getSha(e,encodeURI(t),function(c,l){var f={message:u,content:"undefined"==typeof r.encode||r.encode?s(i):i,branch:e,committer:r&&r.committer?r.committer:void 0,author:r&&r.author?r.author:void 0};c&&404!==c.error||(f.sha=l),n("PUT",o+"/contents/"+encodeURI(t),f,a)})},this.getCommits=function(e,t){e=e||{};var s=o+"/commits",i=[];if(e.sha&&i.push("sha="+encodeURIComponent(e.sha)),e.path&&i.push("path="+encodeURIComponent(e.path)),e.author&&i.push("author="+encodeURIComponent(e.author)),e.since){var u=e.since;u.constructor===Date&&(u=u.toISOString()),i.push("since="+encodeURIComponent(u))}if(e.until){var r=e.until;r.constructor===Date&&(r=r.toISOString()),i.push("until="+encodeURIComponent(r))}e.page&&i.push("page="+e.page),e.perpage&&i.push("per_page="+e.perpage),i.length>0&&(s+="?"+i.join("&")),n("GET",s,null,t)},this.isStarred=function(e,t,o){n("GET","/user/starred/"+e+"/"+t,null,o)},this.star=function(e,t,o){n("PUT","/user/starred/"+e+"/"+t,null,o)},this.unstar=function(e,t,o){n("DELETE","/user/starred/"+e+"/"+t,null,o)}},i.Gist=function(e){var t=e.id,o="/gists/"+t;this.read=function(e){n("GET",o,null,e)},this.create=function(e,t){n("POST","/gists",e,t)},this["delete"]=function(e){n("DELETE",o,null,e)},this.fork=function(e){n("POST",o+"/fork",null,e)},this.update=function(e,t){n("PATCH",o,e,t)},this.star=function(e){n("PUT",o+"/star",null,e)},this.unstar=function(e){n("DELETE",o+"/star",null,e)},this.isStarred=function(e){n("GET",o+"/star",null,e)}},i.Issue=function(e){var t="/repos/"+e.user+"/"+e.repo+"/issues";this.list=function(e,n){var o=[];for(var s in e)e.hasOwnProperty(s)&&o.push(encodeURIComponent(s)+"="+encodeURIComponent(e[s]));u(t+"?"+o.join("&"),n)},this.comment=function(e,t,o){n("POST",e.comments_url,{body:t},o)}},i.Search=function(e){var t="/search/",o="?q="+e.query;this.repositories=function(e,s){n("GET",t+"repositories"+o,e,s)},this.code=function(e,s){n("GET",t+"code"+o,e,s)},this.issues=function(e,s){n("GET",t+"issues"+o,e,s)},this.users=function(e,s){n("GET",t+"users"+o,e,s)}},i};return i.getIssues=function(e,t){return new i.Issue({user:e,repo:t})},i.getRepo=function(e,t){return t?new i.Repository({user:e,name:t}):new i.Repository({fullname:e})},i.getUser=function(){return new i.User},i.getGist=function(e){return new i.Gist({id:e})},i.getSearch=function(e){return new i.Search({query:e})},i});
//# sourceMappingURL=github.min.js.map
