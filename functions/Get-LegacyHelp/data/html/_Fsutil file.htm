<html dir="LTR" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:tool="http://www.microsoft.com/tooltip"><head><meta http-equiv="Content-Type" content="text/html; CHARSET=Windows-1252"><meta name="save" content="history"><title>Fsutil file</title><link rel="stylesheet" type="text/css" href="../local/Classic.css"><script src="../local/script.js"></script></head><body><div><input type="hidden" id="userDataCache" class="userDataStyle"><input type="hidden" id="hiddenScrollOffset"></div><img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif"><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif"><img id="collapseImage" style="display:none; height:0; width:0;" src="../local/collapse.gif"><img id="expandImage" style="display:none; height:0; width:0;" src="../local/exp.gif"><img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif"><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif"><div id="header"><table width="100%" id="topTable"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText"></span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Fsutil file</span></td></tr><tr id="headerTableRow3"><td></td></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p>Applies To: Windows Server 2003 R2,Windows 7,Windows Server 2000,Windows Vista,Windows Server 2003,Windows Server 2008,Windows Server 2008 R2</p>
				<p>Finds a file by user name (if Disk Quotas are enabled), queries allocated ranges for a file, sets a file's short name, sets a file's valid data length, sets zero data for a file, or creates a new file. </p>
				<p>For examples of how to use this command, see <a href="#BKMK_examples">Examples</a>.</p>
			<h2 class="heading">Syntax</h2><div id="sectionSection0" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>fsutil file [createnew] &lt;FileName&gt; &lt;Length&gt;
fsutil file [findbysid] &lt;UserName&gt; &lt;Directory&gt;
fsutil file [queryallocranges] offset=&lt;Offset&gt; length=&lt;Length&gt; &lt;FileName&gt;
fsutil file [quaeryfileid] &lt;FileName&gt;
fsutil file [queryfilenamebyid] &lt;Volume&gt; &lt;Fileid&gt;
fsutil file [setshortname] &lt;FileName&gt; &lt;ShortName&gt;
fsutil file [setvaliddata] &lt;FileName&gt; &lt;DataLength&gt;
fsutil file [setzerodata] offset=&lt;Offset&gt; length=&lt;Length&gt; &lt;FileName&gt;
</pre></td></tr></table></span></div>
				</content></div><h2 class="heading">Parameters</h2><div id="sectionSection1" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<h3 class="subHeading" xmlns=""></h3><table xmlns=""><tr>
								<th colspan="1">
									Parameter
								</th>
								<th colspan="1">
									Description
								</th>
							</tr><tr>
							<td colspan="1">
								<p> createnew </p>
							</td>
							<td colspan="1">
								<p>Creates a file of the specified name and size, with content that consists of zeroes.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p> &lt;FileName&gt; </p>
							</td>
							<td colspan="1">
								<p>Specifies the full path to the file including the file name and extension, for example C:\documents\filename.txt.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p> &lt;Length&gt; </p>
							</td>
							<td colspan="1">
								<p>Specifies the file's valid data length.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p> findbysid </p>
							</td>
							<td colspan="1">
								<p>Finds files that belong to a specified user on NTFS volumes where Disk Quotas are enabled. </p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p> &lt;UserName&gt; </p>
							</td>
							<td colspan="1">
								<p>Specifies the user's user name or logon name.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p> &lt;Directory&gt; </p>
							</td>
							<td colspan="1">
								<p>Specifies the full path to the directory, for example C:\users.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p> queryallocranges </p>
							</td>
							<td colspan="1">
								<p>Queries the allocated ranges for a file on an NTFS volume. Useful for determining whether a file has sparse regions.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p> offset=&lt;Offset&gt; </p>
							</td>
							<td colspan="1">
								<p>Specifies the start of the range that should be set to zeroes.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p> length=&lt;Length&gt; </p>
							</td>
							<td colspan="1">
								<p>Specifies the length of the range (in bytes).</p>
							</td>
						</tr><tr>
							<td>
								<p>queryfileid</p>
							</td>
							<td>
								<p>Queries the file ID of a file on an NTFS volume.</p>
								<p>This parameter applies to: Windows Server® 2008 R2 and Windows® 7.</p>
							</td>
						</tr><tr>
							<td>
								<p>queryfilenamebyid</p>
							</td>
							<td>
								<p>Displays a random link name for a specified file ID on an NTFS volume. Since a file can have more than one link name pointing to that file, it is not guaranteed which file link will be provided as a result of the query for the file name.</p>
								<p>This parameter applies to: Windows Server 2008 R2 and Windows 7.</p>
							</td>
						</tr><tr>
							<td>
								<p>&lt;Fileid&gt;</p>
							</td>
							<td>
								<p>Specifies the ID of the file on an NTFS volume.</p>
							</td>
						</tr><tr>
							<td>
								<p>&lt;Volume&gt;</p>
							</td>
							<td>
								<p>Specifies the volume as drive name followed by a colon.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p> setshortname </p>
							</td>
							<td colspan="1">
								<p>Sets the short name (8.3 character-length file name) for a file on an NTFS volume.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p> &lt;ShortName&gt; </p>
							</td>
							<td colspan="1">
								<p>Specifies the file's short name.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p> setvaliddata </p>
							</td>
							<td colspan="1">
								<p>Sets the valid data length for a file on an NTFS volume.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p> &lt;DataLength&gt; </p>
							</td>
							<td colspan="1">
								<p>Specifies the length of the file in bytes. </p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p> setzerodata </p>
							</td>
							<td colspan="1">
								<p>Sets a range (specified by <i>Offset</i> and <i>Length</i>) of the file to zeroes, which empties the file. If the file is a sparse file, the underlying allocation units are decommitted.</p>
							</td>
						</tr></table>
				</content></div><h2 class="heading">Remarks</h2><div id="sectionSection2" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<ul xmlns=""><li class="unordered">
							In NTFS, there are two important concepts of file length: the end-of-file (EOF) marker and the Valid Data Length (VDL). The EOF indicates the actual length of the file. The VDL identifies the length of valid data on disk. Any reads between VDL and EOF automatically return 0 to preserve the C2 object reuse requirement.<br><br>
						</li><li class="unordered">
							The <b>setvaliddata</b> parameter is only available for administrators because it requires the Perform volume maintenance tasks (SeManageVolumePrivilege) privilege. This feature is only required for advanced multimedia and system area network scenarios. The <b>setvaliddata</b> parameter must be a positive value that is greater than the current VDL, but less than the current file size.<br><br>
							It is useful for programs to set a VDL when:<br><br>
							<ul><li class="unordered">
									Writing raw clusters directly to disk through a hardware channel. This allows the program to inform the file system that this range contains valid data that can be returned to the user.<br><br>
								</li><li class="unordered">
									Creating large files when performance is an issue. This avoids the time it takes to fill the file with zeroes when the file is created or extended.<br><br>
								</li></ul>
						</li></ul>
				</content></div><a name="BKMK_examples"></a><a name="5218abea-2a19-468c-b275-71ebce5aa667#BKMK_examples"></a><h2 class="heading">Examples</h2><div id="sectionSection3" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<p xmlns="">To find files that are owned by scottb on drive C, type:</p>
					<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>fsutil file findbysid scottb c:\users  </pre></td></tr></table></span></div>
					<p xmlns="">To query the allocated ranges for a file on an NTFS volume, type:</p>
					<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>fsutil file queryallocranges offset=1024 length=64 c:\temp\sample.txt  </pre></td></tr></table></span></div>
					<p xmlns="">To set the short name for the file Longfilename.txt on drive C to Longfile.txt, type:</p>
					<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>fsutil file setshortname c:\longfilename.txt longfile.txt  </pre></td></tr></table></span></div>
					<p xmlns="">To set the valid data length to 4096 bytes for a file named Testfile.txt on an NTFS volume, type:</p>
					<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>fsutil file setvaliddata c:\testfile.txt 4096  </pre></td></tr></table></span></div>
					<p xmlns="">To set a range of a file on an NTFS volume to zeros to empty it, type:</p>
					<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>fsutil file setzerodata offset=100 length=150 c:\temp\sample.txt  </pre></td></tr></table></span></div>
				</content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
						</content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
							<h4 class="subHeading" xmlns="">Additional references</h4><div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
									<p xmlns="">
										<a href="338c0381-ad63-4a4c-bd2c-42c7a93821fe.htm">Command-Line Syntax Key</a>
									</p>
									<p xmlns="">
										<a href="097de37c-812c-47b0-872b-4b55ea32b27f.htm">Fsutil</a>
									</p>
								</content></div>
						</sections></div>
				</sections></div><!--[if gte IE 5]>
			<tool:tip element="languageFilterToolTip" avoidmouse="false"/>
		<![endif]--></div><div id="footer"><hr><p></div></div></body></html>