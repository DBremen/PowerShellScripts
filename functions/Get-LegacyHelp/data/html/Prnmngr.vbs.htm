<html dir="LTR" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:tool="http://www.microsoft.com/tooltip"><head><meta http-equiv="Content-Type" content="text/html; CHARSET=Windows-1252"><meta name="save" content="history"><title>Prnmngr.vbs</title><link rel="stylesheet" type="text/css" href="../local/Classic.css"><script src="../local/script.js"></script></head><body><div><input type="hidden" id="userDataCache" class="userDataStyle"><input type="hidden" id="hiddenScrollOffset"></div><img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif"><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif"><img id="collapseImage" style="display:none; height:0; width:0;" src="../local/collapse.gif"><img id="expandImage" style="display:none; height:0; width:0;" src="../local/exp.gif"><img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif"><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif"><div id="header"><table width="100%" id="topTable"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText"></span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Prnmngr.vbs</span></td></tr><tr id="headerTableRow3"><td></td></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p>Applies To: Windows Server 2008,Windows Vista</p>
<p>Adds, deletes, and lists printers or printer connections, in addition to setting and displaying the default printer. </p>

<p>For examples of how this command can be used, see <a href="#BKMK_examples">Examples</a>.</p>
<h2 class="heading">Syntax</h2><div id="sectionSection0" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>Cscript Prnmngr {-a | -d | -x | -g | -t | -l | -?}[c] [-s &lt;ServerName&gt;] <br>[-p &lt;PrinterName&gt;] [-m &lt;PrinterModel&gt;] [-r &lt;PortName&gt;] [-u &lt;UserName&gt;] <br>[-w &lt;Password&gt;]</pre></td></tr></table></span></div>
</content></div><h2 class="heading">Parameters</h2><div id="sectionSection1" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<h3 class="subHeading" xmlns=""></h3><table xmlns=""><tr>
<th colspan="1">
Parameter
</th>
<th colspan="1">
Description
</th></tr><tr>
<td colspan="1">
<p>-a</p>
</td>
<td colspan="1">
<p>Adds a local printer connection.</p>
</td></tr><tr>
<td colspan="1">
<p>-d</p>
</td>
<td colspan="1">
<p>Deletes a printer connection.</p>
</td></tr><tr>
<td colspan="1">
<p>-x</p>
</td>
<td colspan="1">
<p>Deletes all printers from the server specified with the <b>-s</b> parameter. If you do not specify a server, Windows deletes all printers on the local computer.</p>
</td></tr><tr>
<td colspan="1">
<p>-g</p>
</td>
<td colspan="1">
<p>Displays the default printer.</p>
</td></tr><tr>
<td colspan="1">
<p>-t</p>
</td>
<td colspan="1">
<p>Sets the default printer to the printer specified by the <b>-p</b> parameter.</p>
</td></tr><tr>
<td colspan="1">
<p>-l</p>
</td>
<td colspan="1">
<p>Lists all printers installed on the server specified by the <b>-s</b> parameter. If you do not specify a server, Windows lists the printers installed on the local computer.</p>
</td></tr><tr>
<td colspan="1">
<p>c</p>
</td>
<td colspan="1">
<p>Specifies that the parameter applies to printer connections. Can be used with the <b>-a</b> and <b>-x</b> parameters.</p>
</td></tr><tr>
<td colspan="1">
<p>-s &lt;ServerName&gt;</p>
</td>
<td colspan="1">
<p>Specifies the name of the remote computer that hosts the printer that you want to manage. If you do not specify a computer, the local computer is used.</p>
</td></tr><tr>
<td colspan="1">
<p>-p &lt;PrinterName&gt;</p>
</td>
<td colspan="1">
<p>Specifies the name of the printer that you want to manage.</p>
</td></tr><tr>
<td colspan="1">
<p>-m &lt;DriverModelName&gt;</p>
</td>
<td colspan="1">
<p>Specifies (by name) the driver you want to install. Drivers are often named for the model of printer they support. See the printer documentation for more information.</p>
</td></tr><tr>
<td colspan="1">
<p>-r &lt;PortName&gt;</p>
</td>
<td colspan="1">
<p>Specifies the port where the printer is connected. If this is a parallel or a serial port, use the ID of the port (for example, LPT1: or COM1:). If this is a TCP/IP port, use the port name that was specified when the port was added.</p>
</td></tr><tr>
<td colspan="1">
<p>-u &lt;UserName&gt; -w &lt;Password&gt;</p>
</td>
<td colspan="1">
<p>Specifies an account with permissions to connect to the computer that hosts the printer that you want to manage. All members of the target computer's local Administrators group have these permissions, but the permissions can also be granted to other users. If you do not specify an account, you must be logged on under an account with these permissions for the command to work. </p>
</td></tr><tr>
<td colspan="1">
<p>/? </p>
</td>
<td colspan="1">
<p>Displays help at the command prompt.</p>
</td></tr></table>
</content></div><h2 class="heading">Remarks</h2><div id="sectionSection2" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<ul xmlns=""><li class="unordered">
The <b>Prndrvr.vbs</b> command is a Visual Basic script located in the %WINDIR%\System32\Printing_Admin_Scripts\&lt;language&gt; directory. To use this command, at a command prompt, type <b>Cscript</b> followed by the full path to the <b>Prnmngr.vbs</b> file, or change directories to the appropriate folder. For example:<br><br>

<div class="code"><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>Cscript %WINDIR%\System32\Printing_Admin_Scripts\en-US\Prnmngr.vbs</pre></td></tr></table></span></div>
</li><li class="unordered">
If the information that you supply contains spaces, use quotation marks around the text (for example, <code>"Computer Name"</code>).<br><br>
</li></ul>
</content></div><a name="BKMK_examples"></a><a name="39eee1a8-4b41-4c9f-941e-486495135eb8#BKMK_examples"></a><h2 class="heading">Examples</h2><div id="sectionSection3" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns="">To add a printer named ColorPrinter_2 that is connected to LPT1 on the local computer and requires a printer driver called Color Printer Driver1, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>Cscript Prnmngr.vbs -a -p ColorPrinter_2 -m "Color Printer Driver1" -r lpt1:</pre></td></tr></table></span></div>

<p xmlns="">To delete the printer named ColorPrinter_2 from the remote computer named HRServer, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>Cscript Prnmngr.vbs -d -s HRServer -p ColorPrinter_2 </pre></td></tr></table></span></div>
</content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"></content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<h4 class="subHeading" xmlns="">Additional references</h4><div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns=""><a href="338c0381-ad63-4a4c-bd2c-42c7a93821fe.htm">Command-Line Syntax Key</a></p>

<p xmlns=""><a href="88d8fa87-6fa8-4774-9294-080b0157ea8d.htm">Print Command Reference</a></p>
</content></div>
</sections></div>
</sections></div><!--[if gte IE 5]>
			<tool:tip element="languageFilterToolTip" avoidmouse="false"/>
		<![endif]--></div><div id="footer"><hr><p></div></div></body></html>