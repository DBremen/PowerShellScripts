<html dir="LTR" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:tool="http://www.microsoft.com/tooltip"><head><meta http-equiv="Content-Type" content="text/html; CHARSET=Windows-1252"><meta name="save" content="history"><title>Defrag</title><link rel="stylesheet" type="text/css" href="../local/Classic.css"><script src="../local/script.js"></script></head><body><div><input type="hidden" id="userDataCache" class="userDataStyle"><input type="hidden" id="hiddenScrollOffset"></div><img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif"><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif"><img id="collapseImage" style="display:none; height:0; width:0;" src="../local/collapse.gif"><img id="expandImage" style="display:none; height:0; width:0;" src="../local/exp.gif"><img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif"><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif"><div id="header"><table width="100%" id="topTable"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText"></span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Defrag</span></td></tr><tr id="headerTableRow3"><td></td></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p>Applies To: Windows Vista,Windows Server 2008</p>
				<p>Locates and consolidates fragmented files on local volumes to improve system performance.</p>
				<p>Membership in the local <b>Administrators</b> group, or equivalent, is the minimum required to run this command.</p>
				<p>For examples of how this command can be used, see <a href="#BKMK_examples">Examples</a>.</p>
			<h2 class="heading">Syntax</h2><div id="sectionSection0" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>defrag &lt;volumes&gt; | /C | /E &lt;volumes&gt;    [/H] [/M | [/U] [/V]]
defrag &lt;volumes&gt; | /C | /E &lt;volumes&gt; /A [/H] [/M | [/U] [/V]]
defrag &lt;volumes&gt; | /C | /E &lt;volumes&gt; /X [/H] [/M | [/U] [/V]]
defrag &lt;volume&gt; /T [/H] [/U] [/V]</pre></td></tr></table></span></div>
				</content></div><h2 class="heading">Parameters</h2><div id="sectionSection1" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<h3 class="subHeading" xmlns=""></h3><table xmlns=""><tr>
								<th colspan="1">
									Parameter
								</th>
								<th colspan="1">
									Description
								</th>
							</tr><tr>
							<td colspan="1">
								<p>&lt;volume&gt;</p>
							</td>
							<td colspan="1">
								<p>Specifies the drive letter or mount point path of the volume to be defragmented or analyzed.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>C</p>
							</td>
							<td colspan="1">
								<p>Perform the operation on all volumes.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>A</p>
							</td>
							<td colspan="1">
								<p>Perform analysis on the specified volumes.</p>
							</td>
						</tr><tr>
							<td>
								<p>E</p>
							</td>
							<td>
								<p>Perform the operation on all volumes except those specified.</p>
							</td>
						</tr><tr>
							<td>
								<p>H</p>
							</td>
							<td>
								<p>Run the operation at normal priority (default is low).</p>
							</td>
						</tr><tr>
							<td>
								<p>M</p>
							</td>
							<td>
								<p>Run the operation on each volume in parallel in the background.</p>
							</td>
						</tr><tr>
							<td>
								<p>T</p>
							</td>
							<td>
								<p>Track an operation already in progress on the specified volume.</p>
							</td>
						</tr><tr>
							<td>
								<p>U</p>
							</td>
							<td>
								<p>Print the progress of the operation on the screen.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>V</p>
							</td>
							<td colspan="1">
								<p>Print verbose output containing the fragmentation statistics.</p>
							</td>
						</tr><tr>
							<td>
								<p>X</p>
							</td>
							<td>
								<p>Perform free space consolidation on the specified volumes.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>?</p>
							</td>
							<td colspan="1">
								<p>Displays this help information.</p>
							</td>
						</tr></table>
				</content></div><h2 class="heading">Remarks</h2><div id="sectionSection2" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<ul xmlns=""><li class="unordered">
							You cannot defragment specific types of file system volumes or drives:<br><br>
							<ul><li class="unordered">
									You cannot defragment volumes that the file system has locked.<br><br>
								</li><li class="unordered">
									You cannot defragment volumes that the file system has marked as dirty, which indicates possible corruption. You must run <b>chkdsk</b> on a dirty volume before you can defragment it. You can determine if a volume is dirty by using the <b>fsutil</b> dirty query command. For more information about <b>chkdsk</b> and <b>fsutil</b> dirty, see <a href="#BKMK_AdditionalRef">Additional references</a>.<br><br>
								</li><li class="unordered">
									You cannot defragment network drives.<br><br>
								</li><li class="unordered">
									You cannot defragment CDROMs.<br><br>
								</li><li class="unordered">
									You cannot defragment file system volumes that are not <b>NTFS</b>, <b>FAT</b> or <b>FAT32</b>.<br><br>
								</li></ul>
						</li><li class="unordered">
							With Windows Server® 2008 R2, Windows Server 2008, and, Windows Vista®, you can schedule to defragment a volume. However, you cannot schedule to defragment a Solid State Drive (SSD) or a volume on a Virtual Hard Disk (VHD) that resides on an SSD.<br><br>
						</li><li class="unordered">
							To perform this procedure, you must be a member of the Administrators group on the local computer, or you must have been delegated the appropriate authority. If the computer is joined to a domain, members of the Domain Admins group might be able to perform this procedure. As a security best practice, consider using Run as to perform this procedure.<br><br>
						</li><li class="unordered">
							A volume must have at least 15% free space for <b>defrag</b> to completely and adequately defragment it. <b>Defrag</b> uses this space as a sorting area for file fragments. If a volume has less than 15% free space, <b>defrag</b> will only partially defragment it. To increase the free space on a volume, delete unneeded files or move them to another disk.<br><br>
						</li><li class="unordered">
							While <b>defrag</b> is analyzing and defragmenting a volume, it displays a blinking cursor. When <b>defrag</b> is finished analyzing and defragmenting the volume, it displays the analysis report, the defragmentation report, or both reports, and then exits to the command prompt.<br><br>
						</li><li class="unordered">
							By default, <b>defrag</b> displays a summary of both the analysis and defragmentation reports if you do not specify the <b>/a</b> or <b>/v</b> parameters.<br><br>
						</li><li class="unordered">
							You can send the reports to a text file by typing <b>&gt;</b><i>FileName.txt</i>, where <i>FileName.txt</i> is a file name you specify. For example: <code>defragVolume/v&gt;FileName.txt</code><br><br>
						</li><li class="unordered">
							To interrupt the defragmentation process, at the command line, press <b>CTRL+C</b>.<br><br>
						</li><li class="unordered">
							Running the <b>defrag</b> command and Disk Defragmenter are mutually exclusive. If you are using Disk Defragmenter to defragment a volume and you run the <b>defrag</b> command at a command-line, the <b>defrag</b> command fails. Conversely, if you run the <b>defrag</b> command and open Disk Defragmenter, the defragmentation options in Disk Defragmenter are unavailable.<br><br>
						</li></ul>
				</content></div><a name="BKMK_examples"></a><a name="aaf1d1ac-996a-4282-9b4d-1e8245ff162c#BKMK_examples"></a><h2 class="heading">Examples</h2><div id="sectionSection3" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<p xmlns="">To defragment the volume on drive C while providing progress and verbose output, type:</p>
					<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>defrag C: /U /V</pre></td></tr></table></span></div>
					<p xmlns="">To defragment the volumes on drives C and D in parallel in the background, type:</p>
					<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>defrag C: D: /M</pre></td></tr></table></span></div>
					<p xmlns="">To perform a fragmentation analysis of a volume mounted on drive C and provide progress, type:</p>
					<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>defrag C: mountpoint /A /U</pre></td></tr></table></span></div>
					<p xmlns="">To defragment all volumes with normal priority and provide verbose output, type:</p>
					<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>Defrag /C /H /V</pre></td></tr></table></span></div>
				</content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
						</content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
							<a name="BKMK_AdditionalRef" xmlns=""></a><a name="aaf1d1ac-996a-4282-9b4d-1e8245ff162c#BKMK_AdditionalRef" xmlns=""></a><h4 class="subHeading" xmlns="">Additional references</h4><div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
									<ul xmlns=""><li class="unordered">
											
												<a href="62912a3c-d2cc-4ef6-9679-43709a286035.htm">Chkdsk</a>
											<br><br>
										</li><li class="unordered">
											
												<a href="097de37c-812c-47b0-872b-4b55ea32b27f.htm">Fsutil</a>
											<br><br>
										</li><li class="unordered">
											
												<a href="83f271af-dc7e-4641-8e9c-b5da1be50625.htm">Fsutil dirty</a>
											<br><br>
										</li><li class="unordered">
											
												<a href="338c0381-ad63-4a4c-bd2c-42c7a93821fe.htm">Command-Line Syntax Key</a>
											<br><br>
										</li></ul>
								</content></div>
						</sections></div>
				</sections></div><!--[if gte IE 5]>
			<tool:tip element="languageFilterToolTip" avoidmouse="false"/>
		<![endif]--></div><div id="footer"><hr><p></div></div></body></html>