<html dir="LTR" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:tool="http://www.microsoft.com/tooltip"><head><meta http-equiv="Content-Type" content="text/html; CHARSET=Windows-1252"><meta name="save" content="history"><title>LDAP policies</title><link rel="stylesheet" type="text/css" href="../local/Classic.css"><script src="../local/script.js"></script></head><body><div><input type="hidden" id="userDataCache" class="userDataStyle"><input type="hidden" id="hiddenScrollOffset"></div><img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif"><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif"><img id="collapseImage" style="display:none; height:0; width:0;" src="../local/collapse.gif"><img id="expandImage" style="display:none; height:0; width:0;" src="../local/exp.gif"><img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif"><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif"><div id="header"><table width="100%" id="topTable"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText"></span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">LDAP policies</span></td></tr><tr id="headerTableRow3"><td></td></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p>Applies To: Windows Server 2003,Windows Server 2003,Windows Server 2003 R2,Windows Server 2003 R2,Windows Server 2008,Windows Server 2008,Windows Server 2003 with SP1,Windows Server 2003 with SP1</p>
				<p>Sets the Lightweight Directory Access Protocol (LDAP) administration limits for the Default-Query Policy object. At the <code>LDAP policies:</code> prompt, type any of the parameters listed under Syntax.</p>
				<p>This is a subcommand of Ntdsutil and Dsmgmt. Ntdsutil and Dsmgmt are command-line tools that are built into Windows Server 2008 and Windows Server 2008 R2. Ntdsutil is available if you have the Active Directory Domain Services (AD DS) or Active Directory Lightweight Directory Services (AD LDS) server role installed. Dsmgmt is available if you have the AD LDS server role installed. These tools are also available if you install the Active Directory Domain Services Tools that are part of the Remote Server Administration Tools (RSAT). For more information, see <a href="http://go.microsoft.com/fwlink/?LinkID=177813" alt="" target="_blank"><linktext xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">How to Administer Microsoft Windows Client and Server Computers Locally and Remotely</linktext></a> (http://go.microsoft.com/fwlink/?LinkID=177813).</p>
				<p>To use either of these tools, you must run them from an elevated command prompt. To open an elevated command prompt, click <b>Start</b>, right-click <b>Command Prompt</b>, and then click <b>Run as administrator</b>.</p>
				<p>For examples of how to use this command, see <a href="#BKMK_examples">Examples</a>.</p>
			<h2 class="heading">Syntax</h2><div id="sectionSection0" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>connections 
{cancel changes | commit changes} {list | set %s1 to %s2 | show values}</pre></td></tr></table></span></div>
				</content></div><h2 class="heading">Parameters</h2><div id="sectionSection1" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<h3 class="subHeading" xmlns=""></h3><table xmlns=""><tr>
								<th colspan="1">
									Parameter
								</th>
								<th colspan="2">
									Description
								</th>
							</tr><tr>
							<td colspan="1">
								<p>cancel changes</p>
							</td>
							<td colspan="2">
								<p>Cancels any uncommitted modifications of the LDAP administration limits to the default query policy.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>commit changes</p>
							</td>
							<td colspan="2">
								<p>Commits all modifications of the LDAP administration limits to the default query policy.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>connections</p>
							</td>
							<td colspan="2">
								<p>Invokes the <code>Server connections</code> submenu.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>list</p>
							</td>
							<td colspan="2">
								<p>Lists all supported LDAP administration limits for the domain controller.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>set %s1 to %s2</p>
							</td>
							<td colspan="2">
								<p>Sets the value of the LDAP administration limit <i>%s1</i> to the value <i>%s2</i>.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>show values</p>
							</td>
							<td colspan="2">
								<p>Shows the current and proposed values for the LDAP administration limits.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>%s</p>
							</td>
							<td colspan="2">
								<p>An alphanumeric variable, such as a domain or domain controller name.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>quit</p>
							</td>
							<td colspan="2">
								<p>Takes you back to the previous menu, or exits the utility.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>?</p>
							</td>
							<td colspan="2">
								<p>Displays Help at the command prompt.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>Help</p>
							</td>
							<td colspan="1">
								<p>Displays Help at the command prompt.</p>
							</td>
						</tr></table>
				</content></div><h2 class="heading">Remarks</h2><div id="sectionSection2" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<ul xmlns=""><li class="unordered">
							The following table lists and describes the LDAP administration limits, with default values noted in parentheses.<br><br>
							<h3 class="subHeading"></h3><table><tr>
										<th colspan="1">
											Value
										</th>
										<th colspan="1">
											Description
										</th>
									</tr><tr>
									<td colspan="1">
										<p>InitRecvTimeout</p>
									</td>
									<td colspan="1">
										<p>Initial receive time-out (120 seconds)</p>
									</td>
								</tr><tr>
									<td colspan="1">
										<p>MaxConnections</p>
									</td>
									<td colspan="1">
										<p>Maximum number of open connections (5000)</p>
									</td>
								</tr><tr>
									<td colspan="1">
										<p>MaxConnIdleTime</p>
									</td>
									<td colspan="1">
										<p>Maximum amount of time a connection can be idle (900 seconds)</p>
									</td>
								</tr><tr>
									<td colspan="1">
										<p>MaxNotificationPerConnection</p>
									</td>
									<td colspan="1">
										<p>Maximum number of notifications that a client can request for a given connection (5)</p>
									</td>
								</tr><tr>
									<td colspan="1">
										<p>MaxPageSize</p>
									</td>
									<td colspan="1">
										<p>Maximum page size supported for LDAP responses (1000 records)</p>
									</td>
								</tr><tr>
									<td colspan="1">
										<p>MaxQueryDuration</p>
									</td>
									<td colspan="1">
										<p>Maximum length of time the domain controller can execute a query (120 seconds)</p>
									</td>
								</tr><tr>
									<td colspan="1">
										<p>MaxTempTableSize</p>
									</td>
									<td colspan="1">
										<p>Maximum size of temporary storage allocated to execute queries (10,000 records)</p>
									</td>
								</tr><tr>
									<td colspan="1">
										<p>MaxResultSetSize</p>
									</td>
									<td colspan="1">
										<p>Maximum size of the LDAP Result Set (262144 bytes)</p>
									</td>
								</tr><tr>
									<td colspan="1">
										<p>MaxPoolThreads</p>
									</td>
									<td colspan="1">
										<p>Maximum number of threads created by the domain controller for query execution (4 per processor)</p>
									</td>
								</tr><tr>
									<td colspan="1">
										<p>MaxDatagramRecv</p>
									</td>
									<td colspan="1">
										<p>Maximum number of datagrams that can be processed by the domain controller simultaneously (1024)</p>
									</td>
								</tr><tr>
									<td colspan="1">
										<p>MaxReceiveBuffer</p>
									</td>
									<td colspan="1">
										<p>The maximum size, in bytes, of a request that the server will accept (10,485,760 bytes)</p>
									</td>
								</tr><tr>
									<td colspan="1">
										<p>MaxValRange</p>
									</td>
									<td colspan="1">
										<p>The maximum number of values that can be retrieved from a multivalued attribute in a single search request (1500 values). This policy is available only in Windows Server 2003 and Windows Server 2008.</p>
									</td>
								</tr></table>
						</li><li class="unordered">
							To ensure that domain controllers can support service-level guarantees, you can specify operational limits for a number of LDAP operations. These limits prevent specific operations from adversely impacting the performance of the server and also make the server resilient to denial-of-service attacks.<br><br>
							LDAP policies are implemented by using objects of the class <b>queryPolicy</b>. Query Policy objects can be created in the container Query Policies, which is a child of the Directory Service container in the configuration directory partition, for example, CN=Query-Policies,CN=Directory Service,CN=Windows NT,CN=Services (configuration directory partition).<br><br>
							A domain controller uses the following three mechanisms to apply LDAP policies:<br><br>
							<ul><li class="unordered">
									A domain controller might refer to a specific LDAP policy. The NTDS Settings object includes an optional attribute <b>queryPolicyObject</b>, which contains the distinguished name of a Query Policy.<br><br>
								</li><li class="unordered">
									In the absence of a specific query policy being applied to a domain controller, the domain controller applies the Query Policy that has been assigned to the domain controller's site. The ntDSSiteSettings object includes an optional attribute <b>queryPolicyObject</b>, which contains the distinguished name of a Query Policy.<br><br>
								</li><li class="unordered">
									In the absence of a specific domain controller or site Query Policy, a domain controller uses the default query policy named Default-Query Policy.<br><br>
									A Query Policy object includes the multivalued attributes <b>LDAPIPDenyList</b> and <b>LDAPAdminLimits</b>. Ntdsutil allows the administrator to set the LDAP administration limits and IP Deny list for the Default-Query Policy object.<br><br>
								</li><li class="unordered">
									
										Ntdsutil does not correctly handle special characters, such as the apostrophe character ('), that you can enter at the <b>ntdsutil:</b> prompt at the command line. In some situations, there may be an alternative workaround. For more information, see <a href="http://go.microsoft.com/fwlink/?LinkId=157320" alt="" target="_blank"><maml:linktext xmlns:maml="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">local roles</maml:linktext></a> (http://go.microsoft.com/fwlink/?LinkId=157320).
									<br><br>
								</li></ul>
						</li></ul>
				</content></div><a name="BKMK_examples"></a><a name="309950c8-5bfa-4b9e-b4a2-706ac63948ec#BKMK_examples"></a><h2 class="heading">Examples</h2><div id="sectionSection3" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<p xmlns="">To show the current <code>ldap</code> policy values, type the following command, and then press ENTER:</p>
					<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>ldap policy: show values</pre></td></tr></table></span></div>
				</content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
						</content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
							<h4 class="subHeading" xmlns="">Additional references</h4><div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
									<p xmlns="">
										<a href="338c0381-ad63-4a4c-bd2c-42c7a93821fe.htm">Command-Line Syntax Key</a>
									</p>
<p xmlns=""><a href="c525f20d-fdcf-4da8-8450-cce9988bc811.htm">Dsmgmt</a></p><p xmlns=""><a href="199cebb9-967c-4307-a9d7-1c0bb50dc75b.htm">Ntdsutil</a></p><p xmlns=""><a href="b5416510-9aa5-44e4-8b4b-279dee264183.htm">authoritative restore</a></p><p xmlns=""><a href="f27dc4c0-0623-401b-b411-48acf995f595.htm">configurable settings</a></p><p xmlns=""><a href="baa9c5e1-0c26-4d57-8ca9-ff5b15c33d29.htm">DS behavior</a></p><p xmlns=""><a href="594c47bc-095d-465e-b7cb-3f0234350460.htm">files</a></p><p xmlns=""><a href="dc3722d8-b6de-4863-b456-1b17139caa42.htm">group membership evaluation</a></p><p xmlns=""><a href="c705e804-97d5-4a15-8d60-1ba09e5544e6.htm">ifm</a></p><p xmlns=""><a href="309950c8-5bfa-4b9e-b4a2-706ac63948ec.htm">LDAP policies</a></p><p xmlns=""><a href="aee69f2f-49bf-49cb-ac0b-eccc26423b1f.htm">local roles</a></p><p xmlns=""><a href="8ff66708-2ad0-4f52-982d-376a50a0e2dd.htm">metadata cleanup</a></p><p xmlns=""><a href="8ee336a2-b784-4743-8500-8d224a372110.htm">partition management</a></p><p xmlns=""><a href="f74c0470-3b2d-422c-bbbc-385cf39ec175.htm">roles</a></p><p xmlns=""><a href="1a4153d9-eb6e-4c50-8063-eb4ce961c32c.htm">security account management</a></p><p xmlns=""><a href="16b6f806-20b9-47bd-92c5-5cd96645c3bf.htm">semantic database analysis</a></p><p xmlns=""><a href="66fbd855-b3ee-434f-b890-c96858da8178.htm">set DSRM password</a></p><p xmlns=""><a href="a4b0e355-cbd0-4f48-9484-877fad1789ec.htm">snapshot</a></p></content></div>
						</sections></div>
				</sections></div><!--[if gte IE 5]>
			<tool:tip element="languageFilterToolTip" avoidmouse="false"/>
		<![endif]--></div><div id="footer"><hr><p></div></div></body></html>