<html dir="LTR" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:tool="http://www.microsoft.com/tooltip"><head><meta http-equiv="Content-Type" content="text/html; CHARSET=Windows-1252"><meta name="save" content="history"><title>Dsquery server</title><link rel="stylesheet" type="text/css" href="../local/Classic.css"><script src="../local/script.js"></script></head><body><div><input type="hidden" id="userDataCache" class="userDataStyle"><input type="hidden" id="hiddenScrollOffset"></div><img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif"><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif"><img id="collapseImage" style="display:none; height:0; width:0;" src="../local/collapse.gif"><img id="expandImage" style="display:none; height:0; width:0;" src="../local/exp.gif"><img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif"><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif"><div id="header"><table width="100%" id="topTable"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText"></span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Dsquery server</span></td></tr><tr id="headerTableRow3"><td></td></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p>Applies To: Windows Server 2008 R2,Windows Server 2008</p>
<p>Finds domain controllers that match search criteria that you specify. If the predefined search criteria in this command are insufficient, use the more general version of the query command, <b>dsquery *</b>.</p>

<p><b>Dsquery</b> is a command-line tool that is built into Windows Server 2008. It is available if you have the Active Directory Domain Services (AD DS) server role installed. To use <b>dsquery</b>, you must run the <b>dsquery</b> command from an elevated command prompt. To open an elevated command prompt, click <b>Start</b>, right-click <b>Command Prompt</b>, and then click <b>Run as administrator</b>.</p>

<p>For examples of how to use this command, see <a href="#BKMK_examples">Examples</a>.</p>
<h2 class="heading">Syntax</h2><div id="sectionSection0" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>dsquery server [-o {dn | rdn}] [-forest] [-domain &lt;DomainName&gt;] [-site &lt;SiteName&gt;] [-name &lt;Name&gt;] [-desc &lt;Description&gt;] [-hasfsmo {schema | name | infr | pdc | rid}] [-isgc] [{-s &lt;Server&gt; | -d &lt;Domain&gt;}] [-u &lt;UserName&gt;] [-p {&lt;Password&gt; | *}] [-q] [-r] [-gc] [-limit &lt;NumberOfObjects&gt;] [{-uc | -uco | -uci}]</pre></td></tr></table></span></div>
</content></div><h2 class="heading">Parameters</h2><div id="sectionSection1" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<h3 class="subHeading" xmlns=""></h3><table xmlns=""><tr>
<th colspan="1">
Parameter
</th>
<th colspan="2">
Description
</th></tr><tr>
<td colspan="1">
<p>-o {dn | rdn} </p>
</td>
<td colspan="2">
<p>Specifies the format that <b>dsquery</b> uses to display the search results. A <b>dn</b> value displays the distinguished name of each entry. An <b>rdn</b> value displays the relative distinguished name of each entry. The default value is <b>dn</b>.</p>
</td></tr><tr>
<td colspan="1">
<p>-forest </p>
</td>
<td colspan="2">
<p>Searches for all domain controllers (server objects) that are part of the current forest.</p>
</td></tr><tr>
<td colspan="1">
<p>-domain &lt;DomainName&gt; </p>
</td>
<td colspan="2">
<p>Searches for all domain controllers (server objects) that are part of the domain whose Domain Name System (DNS) names you specify in &lt;DomainName&gt;. Search displays all domain controllers in the current domain by default.</p>
</td></tr><tr>
<td colspan="1">
<p>-site &lt;SiteName&gt; </p>
</td>
<td colspan="2">
<p>Searches for all domain controllers (server objects) that are part of the &lt;SiteName&gt; site.</p>
</td></tr><tr>
<td colspan="1">
<p>-name &lt;Name&gt; </p>
</td>
<td colspan="2">
<p>Searches for server objects whose name attributes (value of CN attribute) match &lt;Name&gt;. For example, "jon*", "*ith", or "j*th".</p>
</td></tr><tr>
<td colspan="1">
<p>-desc &lt;Description&gt; </p>
</td>
<td colspan="2">
<p>Searches for server objects whose description attributes match &lt;Description&gt;. For example, "jon*", "*ith", or "j*th".</p>
</td></tr><tr>
<td colspan="1">
<p>[-hasfsmo {schema | name | infr | pdc | rid} </p>
</td>
<td colspan="1">
<p>Searches for the domain controller (server object) that holds the operations master role that you specify. </p>

<p>The following list explains the possible values for this parameter.</p>
<ul><li class="unordered"><b>schema</b>: Specifies the schema master of the forest.<br><br></li><li class="unordered"><b>name</b>: Specifies the domain naming master of the forest.<br><br></li><li class="unordered"><b>infr</b>: Specifies the infrastructure master of the domain that you specify in the <b>-domain</b> parameter or the current domain if you do not specify the <b>-domain</b> parameter.<br><br></li><li class="unordered"><b>pdc</b>: Specifies the primary domain controller (PDC) role owner of the domain that you specify in the <b>-domain</b> parameter or the current domain if you do not specify the <b>-domain</b> parameter.<br><br></li><li class="unordered"><b>rid</b>: Specifies the relative identifier master (RID master) of the domain that you specify in the <b>-domain</b> parameter or the current domain if you do not specify the <b>-domain</b> parameter.<br><br>If you do not specify a <b>rid</b> value in the <b>-domain</b> parameter, <b>rid</b> uses the current domain.<br><br></li></ul>

</td></tr><tr>
<td colspan="1">
<p>-isgc </p>
</td>
<td colspan="1">
<p>Searches for all domain controllers (server objects) that are global catalog servers in the scope specified by any of the <b>-forest</b>, <b>-domain</b>, or <b>-site</b> scope parameters. If you specify none of those scope parameters, this parameter finds all global catalogs that are in the current domain.</p>
</td></tr><tr>
<td colspan="1">
<p>{-s &lt;Server&gt; | -d &lt;Domain&gt;}</p>
</td>
<td colspan="2">
<p>Connects a computer to a remote server or domain that you specify. By default, <b>dsquery</b> connects the computer to the domain controller in the logon domain.</p>
</td></tr><tr>
<td colspan="1">
<p>-u &lt;UserName&gt; </p>
</td>
<td colspan="2">
<p>Specifies the user name with which the user logs on to a remote server. By default, <b>-u</b> uses the user name with which the user logged on. You can use any of the following formats to specify a user name:</p>

<ul><li class="unordered">
user name (for example, Linda)<br><br>
</li><li class="unordered">
domain\user name (for example, widgets\Linda)<br><br>
</li><li class="unordered">
user principal name (UPN) (for example, Linda@widgets.contoso.com)<br><br>
</li></ul>
</td></tr><tr>
<td colspan="1">
<p>-p {&lt;Password&gt; | *}</p>
</td>
<td colspan="2">
<p>Specifies to use either a password or an asterisk (*) to log on to a remote server. If you type <b>*</b>, <b>dsquery</b> prompts you for a password.</p>
</td></tr><tr>
<td colspan="1">
<p>-q </p>
</td>
<td colspan="2">
<p>Suppresses all output to standard output (quiet mode).</p>
</td></tr><tr>
<td colspan="1">
<p>-r </p>
</td>
<td colspan="2">
<p>Specifies that the search use recursion or follow referrals during search. By default, the search will not follow referrals during search.</p>
</td></tr><tr>
<td colspan="1">
<p>-gc </p>
</td>
<td colspan="2">
<p>Specifies that the search use the Active Directory global catalog.</p>
</td></tr><tr>
<td colspan="1">
<p>-limit &lt;NumberOfObjects&gt; </p>
</td>
<td colspan="2">
<p>Specifies the number of objects to return that matches the criteria that you specify. If you specify a value of <b>0</b> for &lt;NumberOfObjects&gt;, this parameter returns all matching objects. If you do not specify this parameter, <b>dsquery</b> displays the first 100 results by default.</p>
</td></tr><tr>
<td colspan="1">
<p>{-uc | -uco | -uci} </p>
</td>
<td colspan="2">
<p>Specifies that <b>dsquery</b> formats output or input data in Unicode. The following list explains each format.</p>

<ul><li class="unordered"><b>-uc</b>: Specifies a Unicode format for input from or output to a pipe (|).<br><br></li><li class="unordered"><b>-uco </b>: Specifies a Unicode format for output to a pipe (|) or a file.<br><br></li><li class="unordered"><b>-uci</b>: Specifies a Unicode format for input from a pipe (|) or a file.<br><br></li></ul>
</td></tr><tr>
<td colspan="1">
<p>/? </p>
</td>
<td colspan="2">
<p>Displays help at the command prompt.</p>
</td></tr></table>
</content></div><h2 class="heading">Remarks</h2><div id="sectionSection2" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<ul xmlns=""><li class="unordered">
The results from a <b>dsquery</b> search can be piped as input to one of the other directory service command-line tools, such as Dsget, Dsmod, Dsmove, or Dsrm.<br><br>
</li><li class="unordered">
If a value that you supply contains spaces, use quotation marks around the text, for example, "CN=Mike Danseglio,CN=Users,DC=Contoso,DC=Com".<br><br>
</li><li class="unordered">
If you supply multiple values for a parameter, use spaces to separate the values, for example, a list of distinguished names.<br><br>
</li></ul>
</content></div><a name="BKMK_examples"></a><a name="d65e470a-8158-4f29-abb2-0229f207c57f#BKMK_examples"></a><h2 class="heading">Examples</h2><div id="sectionSection3" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns="">To find all domain controllers in the current domain, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>dsquery server </pre></td></tr></table></span></div>

<p xmlns="">To find all domain controllers in the forest, and then display their relative distinguished names, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>dsquery server -o rdn -forest </pre></td></tr></table></span></div>

<p xmlns="">To find all domain controllers in the site whose names are United States, and then display their relative distinguished names, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>dsquery server -o rdn -site United States </pre></td></tr></table></span></div>

<p xmlns="">To find the domain controller in the forest that holds the schema operations master role, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>dsquery server –forest –hasfsmo schema </pre></td></tr></table></span></div>

<p xmlns="">To find all domain controllers in the domain widgets.contoso.com that are global catalog servers, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>dsquery server –domain widgets.contoso.com -isgc</pre></td></tr></table></span></div>
</content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"></content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<h4 class="subHeading" xmlns="">Additional references</h4><div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns=""><a href="338c0381-ad63-4a4c-bd2c-42c7a93821fe.htm">Command-Line Syntax Key</a></p>

<p xmlns=""><a href="d9ded34b-7ed0-4280-b524-a55c9c6c7b69.htm">Dsquery</a></p>

<p xmlns=""><a href="518175fa-0ab5-49d1-bdd2-d6784ee8b0f6.htm">Dsquery computer</a></p>

<p xmlns=""><a href="46cb2760-9f62-438e-8142-2783a8782798.htm">Dsquery contact</a></p>

<p xmlns=""><a href="692b373b-02c6-4b93-83cd-6b358a773b8d.htm">Dsquery group</a></p>

<p xmlns=""><a href="0ff187ac-afa9-4071-9d1c-f195591ea2ce.htm">Dsquery ou</a></p>

<p xmlns=""><a href="b6e27a9a-6ca3-4dd2-b502-106a9e686b3e.htm">Dsquery site</a></p>

<p xmlns=""><a href="2c836857-912a-425c-9112-b58adbf06214.htm">Dsquery user</a></p>

<p xmlns=""><a href="10a23111-3970-46d3-a2c4-5ea52b3a65e7.htm">Dsquery quota</a></p>

<p xmlns=""><a href="f85cda4b-4be1-41e2-afe3-a9815e70fc4d.htm">Dsquery partition</a></p>

<p xmlns=""><a href="5f90d5cd-ef33-47ee-8bc2-0ca70f271378.htm">Dsquery *</a></p>
</content></div>
</sections></div>
</sections></div><!--[if gte IE 5]>
			<tool:tip element="languageFilterToolTip" avoidmouse="false"/>
		<![endif]--></div><div id="footer"><hr><p></div></div></body></html>