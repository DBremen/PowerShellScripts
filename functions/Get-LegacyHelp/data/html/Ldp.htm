<html dir="LTR" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:tool="http://www.microsoft.com/tooltip"><head><meta http-equiv="Content-Type" content="text/html; CHARSET=Windows-1252"><meta name="save" content="history"><title>Ldp</title><link rel="stylesheet" type="text/css" href="../local/Classic.css"><script src="../local/script.js"></script></head><body><div><input type="hidden" id="userDataCache" class="userDataStyle"><input type="hidden" id="hiddenScrollOffset"></div><img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif"><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif"><img id="collapseImage" style="display:none; height:0; width:0;" src="../local/collapse.gif"><img id="expandImage" style="display:none; height:0; width:0;" src="../local/exp.gif"><img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif"><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif"><div id="header"><table width="100%" id="topTable"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText"></span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Ldp</span></td></tr><tr id="headerTableRow3"><td></td></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p>Applies To: Windows Server 2008</p>
<p>Performs operations such as connect, bind, search, modify, add, delete against any Lightweight Directory Access Protocol (LDAP)-compatible directory, such as Active Directory Domain Services (AD DS). <b>Ldp</b> is an LDAP client that you use to view objects that are stored in AD DS along with their metadata, such as security descriptors and replication metadata.</p>

<div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="../local/note.gif">Note </th></tr><tr><td>
<b>Ldp</b> is a graphical user interface (GUI)-based, Windows Explorer–like tool with a scope pane on the left that is used for navigating through the Active Directory namespace, and a details pane on the right that is used for displaying the results of the LDAP operations. Any text that is displayed in the details pane can be selected with the mouse and copied to the Clipboard.<p>
</td></tr></table><p></div>

<p><b>Ldp</b> is built into Windows Server 2008. It is available if you have the AD DS server role installed. To start <b>ldp</b>, click <b>Start</b>, click <b>Run</b>, type <b>ldp</b> and then click <b>OK</b>.</p>

<p>For examples of how to use this command, see <a href="#BKMK_examples">Examples</a>.</p>
<h2 class="heading">Finding required and optional values for an attribute</h2><div id="sectionSection0" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns="">The schema defines objects as well as the attributes and permissible values for each. Schema classes that contain attribute information about objects can be viewed. To view this information, search cn=Schema,cn=Configuration,dc=ForestRootDomain for classSchema objects.</p>
</content></div><h2 class="heading">Understanding bind options for LDAP authentication</h2><div id="sectionSection1" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns="">There are several authentication methods available in <b>ldp</b> that allow a client to bind to an LDAP server. The best method depends on several factors.</p>

<h3 class="subHeading" xmlns=""></h3><table xmlns=""><tr>
<th colspan="1">
Method
</th>
<th colspan="1">
Description
</th></tr><tr>
<td colspan="1">
<p>Simple</p>
</td>
<td colspan="1">
<p>Cleartext password. Try not to use this, as it is not secure.</p>
</td></tr><tr>
<td colspan="1">
<p>MSN</p>
</td>
<td colspan="1">
<p>MSN (Microsoft Network) authentication. This package brings up a dialog box to prompt the user for MSN credentials.</p>
</td></tr><tr>
<td colspan="1">
<p>DPA</p>
</td>
<td colspan="1">
<p>Normandy authentication, new MSN authentication. Same usage as MSN.</p>
</td></tr><tr>
<td colspan="1">
<p>NTLM</p>
</td>
<td colspan="1">
<p>Windows NT domain authentication. Use NULL credentials and attempt to use default logged-in user credentials.</p>
</td></tr><tr>
<td colspan="1">
<p>Sicily</p>
</td>
<td colspan="1">
<p>Negotiate with the server for any of: MSN, DPA, NTLM. Should be used for LDAPv2 servers only.</p>
</td></tr><tr>
<td colspan="1">
<p>Negotiate</p>
</td>
<td colspan="1">
<p>Use GSSAPI Negotiate package to negotiate security package of either Kerberos V5 or NTLM (or any other package the client and server negotiate). Pass in NULL credentials to specify default logged-in user. If Negotiate package is not installed on server or client, this will fall back to Sicily negotiation.</p>
</td></tr></table>
</content></div><a name="BKMK_examples"></a><a name="319a46f2-7a37-4274-9e24-c7558ce663e0#BKMK_examples"></a><h2 class="heading">Examples</h2><div id="sectionSection2" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns=""><b>Example 1: Add a new object to an LDAP directory</b></p>

<p xmlns="">To add a user to Active Directory by using <b>ldp</b>:</p>

<ol class="ordered" xmlns=""><li>
On the <b>Browse</b> menu, click <b>Add child</b>.<br><br>
</li><li>
In the <b>Add</b> dialog box, in the <b>Dn</b> input box, enter the distinguished name of the new object.<br><br>
</li><li>
In the <b>Edit Entry</b> section, add the new attributes and values. Click <b>Enter</b> after typing in each attribute and associated value: <br><br>

<h3 class="subHeading"></h3><table><tr>
<th colspan="1">
Attribute
</th>
<th colspan="1">
Value
</th></tr><tr>
<td colspan="1">
<p>userAccountControl</p>
</td>
<td colspan="1">
<p>512</p>
</td></tr><tr>
<td colspan="1">
<p>ObjectClass</p>
</td>
<td colspan="1">
<p>User</p>
</td></tr><tr>
<td colspan="1">
<p>SamAccountName</p>
</td>
<td colspan="1">
<p>Testuser2</p>
</td></tr></table>
</li><li>
To add the attribute or value combination to the <b>Entry List</b> box, click <b>Edit</b>.<br><br>
</li><li>
To add the information to Active Directory using LDAP APIs when all the attributes are entered, click <b>Run</b>.<br><br>
</li></ol>

<p xmlns=""><b>Example 2: Search an LDAP directory</b></p>

<p xmlns="">To search Active Directory by using <b>ldp</b>:</p>

<ul xmlns=""><li class="unordered">
On the <b>Browse</b> menu, click <b>Search</b>. <br><br>

The <b>Search</b> dialog box opens.<br><br>
</li></ul>

<p xmlns="">In the following searches, the LDAP directory is AD DS. For user names, it contains a <b>givenName</b> attribute for first names, and an attribute of <b>sn</b> for last names.</p>

<ul xmlns=""><li class="unordered">
To search for all users that have a first name of John and a last name of either Smith or Jones, type the following in the <b>Filter</b> field: <br><br>

<div class="code"><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>(&amp;(objectClass=user)(givenName=John)(|(sn=Smith)(sn=Jones))))</pre></td></tr></table></span></div>
</li><li class="unordered">
To search for users that have a last name of Jones, but filter out those users that have a first name of John or Jane, and also filter out users that have not logged on at least 100 times, type the following in the <b>Filter</b> field. (The exclamation point (!) is the NOT operator.) <br><br>

<div class="code"><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>(&amp;(objectClass=user)(sn=Jones)(!givenName=John)(!givenName=Jane)(!logonCount&lt;=100))</pre></td></tr></table></span></div>
</li><li class="unordered">
To search for reserved characters as part of an attribute value, you must precede the reserved character with an escape character. Use the following escape characters to represent the associated characters:<br><br>

<h3 class="subHeading"></h3><table><tr>
<th colspan="1">
Character
</th>
<th colspan="1">
Escape character
</th></tr><tr>
<td colspan="1">
<p>*</p>
</td>
<td colspan="1">
<p>2a</p>
</td></tr><tr>
<td colspan="1">
<p>(</p>
</td>
<td colspan="1">
<p>28</p>
</td></tr><tr>
<td colspan="1">
<p>)</p>
</td>
<td colspan="1">
<p>29</p>
</td></tr><tr>
<td colspan="1">
<p>\</p>
</td>
<td colspan="1">
<p>5c</p>
</td></tr><tr>
<td colspan="1">
<p>NUL</p>
</td>
<td colspan="1">
<p>00</p>
</td></tr></table>
</li><li class="unordered">
To search for all of the users whose display names end in a close parenthesis character, type the following in the <b>Filter</b> field:<br><br>

<div class="code"><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>(&amp;(objectClass=user)(displayName=*\29))</pre></td></tr></table></span></div>
</li><li class="unordered">
To search for all users who have a surname that starts with the letter J, type the following in the <b>Filter</b> field. (Queries support the wildcard character (<b>*</b>).)<br><br>

<div class="code"><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>(&amp;(objectClass=user)(sn=j*))</pre></td></tr></table></span></div>
</li><li class="unordered">
To search for users whose home directories are G:\Accounting, type the following in the <b>Filter</b> field. (The attribute name is <b>home-directory</b>.)<br><br>

<div class="code"><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>(&amp;(objectClass=user)(home-directory=G:\5cACCOUNTING*))</pre></td></tr></table></span></div>
</li></ul>

<p xmlns=""><b>Example 3: Control the returns on a search of an LDAP directory</b></p>

<p xmlns="">In this example, you use the <b>Search Options</b> dialog box to control which attributes are displayed in a search. Just a few attributes are displayed; the rest are filtered and do not display in the details window of <b>ldp</b>.</p>

<p xmlns="">To control which attributes display:</p>

<ul xmlns=""><li class="unordered">
In the <b>Attributes</b> input box, type the attributes to display: <br><br>

<div class="code"><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>"memberof;range:1-20"objectClass;objectGUID</pre></td></tr></table></span></div>

<div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="../local/note.gif">Note </th></tr><tr><td>
Separate attributes with a semicolon. No spaces are necessary. All other attributes will be filtered out of the display.<p>
</td></tr></table><p></div>

<div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="../local/note.gif">Note </th></tr><tr><td>
A range is specified for the <b>memberof</b> attribute. Because a semicolon is used, the entire section must be separated from the rest of the attributes by quotation marks.<p>
</td></tr></table><p></div>
</li></ul>

<p xmlns="">All searches display only the <b>memberof</b>, <b>objectClass</b>, and <b>objectGUID</b> attributes in the details pane. To return all attributes, replace any existing list of attributes with the wildcard character (<b>*</b>).</p>

<p xmlns=""><b>Example 4: View replication metadata for an object</b></p>

<p xmlns="">To list the replication metadata for an object in Active Directory: </p>

<ol class="ordered" xmlns=""><li>
On the <b>Browse</b> menu, point to <b>Replication</b> and then click<b> View Metadata</b>. <br><br>

The <b>Replication Metadata</b> dialog box opens.<br><br>
</li><li>
In the <b>Object DN</b> field, enter the distinguished name of the object, and then click <b>OK</b>. <br><br>

The output will look similar to the output in the following table.<br><br>

<h3 class="subHeading"></h3><table><tr>
<th colspan="1">
AttID
</th>
<th colspan="1">
Ver
</th>
<th colspan="1">
Loc.USN
</th>
<th colspan="1">
Originating DSA
</th>
<th colspan="1">
Org.USN
</th>
<th colspan="1">
Org.Time/Date
</th></tr><tr>
<td colspan="1">
<p>0</p>
</td>
<td colspan="1">
<p>1</p>
</td>
<td colspan="1">
<p>3693</p>
</td>
<td colspan="1">
<p>9fad4c38-2d76-44b2-84f6-f2fe384f8450</p>
</td>
<td colspan="1">
<p>3693</p>
</td>
<td colspan="1">
<p>2000-12-29 09:15.02</p>
</td></tr><tr>
<td colspan="1">
<p>3</p>
</td>
<td colspan="1">
<p>1</p>
</td>
<td colspan="1">
<p>3693</p>
</td>
<td colspan="1">
<p>9fad4c38-2d76-44b2-84f6-f2fe384f8450</p>
</td>
<td colspan="1">
<p>3693</p>
</td>
<td colspan="1">
<p>2000-12-29 09:15.02</p>
</td></tr><tr>
<td colspan="1">
<p>d</p>
</td>
<td colspan="1">
<p>1</p>
</td>
<td colspan="1">
<p>3693</p>
</td>
<td colspan="1">
<p>9fad4c38-2d76-44b2-84f6-f2fe384f8450</p>
</td>
<td colspan="1">
<p>3693</p>
</td>
<td colspan="1">
<p>2000-12-29 09:15.02</p>
</td></tr><tr>
<td colspan="1">
<p>20001</p>
</td>
<td colspan="1">
<p>1</p>
</td>
<td colspan="1">
<p>3693</p>
</td>
<td colspan="1">
<p>9fad4c38-2d76-44b2-84f6-f2fe384f8450</p>
</td>
<td colspan="1">
<p>3693</p>
</td>
<td colspan="1">
<p>2000-12-29 09:15.02</p>
</td></tr><tr>
<td colspan="1">
<p>20002</p>
</td>
<td colspan="1">
<p>1</p>
</td>
<td colspan="1">
<p>3693</p>
</td>
<td colspan="1">
<p>9fad4c38-2d76-44b2-84f6-f2fe384f8450</p>
</td>
<td colspan="1">
<p>3693</p>
</td>
<td colspan="1">
<p>2000-12-29 09:15.02</p>
</td></tr></table>
</li></ol>
</content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"></content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<h4 class="subHeading" xmlns="">Additional references</h4><div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns=""><a href="338c0381-ad63-4a4c-bd2c-42c7a93821fe.htm">Command-Line Syntax Key</a></p>
</content></div>
</sections></div>
</sections></div><!--[if gte IE 5]>
			<tool:tip element="languageFilterToolTip" avoidmouse="false"/>
		<![endif]--></div><div id="footer"><hr><p></div></div></body></html>