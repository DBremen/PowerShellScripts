<html dir="LTR" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:tool="http://www.microsoft.com/tooltip"><head><meta http-equiv="Content-Type" content="text/html; CHARSET=Windows-1252"><meta name="save" content="history"><title>Csvde</title><link rel="stylesheet" type="text/css" href="../local/Classic.css"><script src="../local/script.js"></script></head><body><div><input type="hidden" id="userDataCache" class="userDataStyle"><input type="hidden" id="hiddenScrollOffset"></div><img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif"><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif"><img id="collapseImage" style="display:none; height:0; width:0;" src="../local/collapse.gif"><img id="expandImage" style="display:none; height:0; width:0;" src="../local/exp.gif"><img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif"><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif"><div id="header"><table width="100%" id="topTable"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText"></span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Csvde</span></td></tr><tr id="headerTableRow3"><td></td></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p>Applies To: Windows Server 2003,Windows Server 2003 R2,Windows Server 2003 with SP1,Windows Server 2008,Windows Server 2008 R2</p>
				<p>Imports and exports data from Active Directory Domain Services (AD DS) using files that store data in the comma-separated value (CSV) format. You can also support batch operations based on the CSV file format standard.</p>
				<p>
					<b>Csvde</b> is a command-line tool that is built into Windows Server 2008 in the %windir%/system32 folder. It is available if you have the AD DS or Active Directory Lightweight Directory Services (AD LDS) server role installed. To use <b>csvde</b>, you must run the <b>csvde</b> command from an elevated command prompt. To open an elevated command prompt, click <b>Start</b>, right-click <b>Command Prompt</b>, and then click <b>Run as administrator</b>. </p>
				<p>For examples of how to use this command, see <a href="#BKMK_examples">Examples</a>.</p>
			<h2 class="heading">Syntax</h2><div id="sectionSection0" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>Csvde [-i] [-f &lt;FileName&gt;] [-s &lt;ServerName&gt;] [-c &lt;String1&gt; &lt;String2&gt;] [-v] [-j &lt;Path&gt;] [-t &lt;PortNumber&gt;] [-d &lt;BaseDN&gt;] [-r &lt;LDAPFilter&gt;] [-p &lt;Scope] [-l &lt;LDAPAttributeList&gt;] [-o &lt;LDAPAttributeList&gt;] [-g] [-m] [-n] [-k] [-a &lt;UserDistinguishedName&gt; {&lt;Password&gt; | *}] [-b &lt;UserName&gt; &lt;Domain&gt; {&lt;Password&gt; | *}]</pre></td></tr></table></span></div>
				</content></div><h2 class="heading">Parameters</h2><div id="sectionSection1" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<h3 class="subHeading" xmlns=""></h3><table xmlns=""><tr>
								<th colspan="1">
									Parameter
								</th>
								<th colspan="1">
									Description
								</th>
							</tr><tr>
							<td colspan="1">
								<p>-i </p>
							</td>
							<td colspan="1">
								<p>Specifies import mode. If not specified, the default mode is export.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>-f &lt;FileName&gt; </p>
							</td>
							<td colspan="1">
								<p>Identifies the import or export file name.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>-s &lt;ServerName&gt; </p>
							</td>
							<td colspan="1">
								<p>Specifies the domain controller to perform the import or export operation.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>-c &lt;String1&gt; &lt;String2&gt; </p>
							</td>
							<td colspan="1">
								<p>Replaces all occurrences of <i>String1</i> with <i>String2</i>. You use this parameter when you import data from one domain to another and you want to replace the distinguished name of the export domain (<i>String1</i>) with the distinguished name of the import domain (<i>String2</i>).</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>-v </p>
							</td>
							<td colspan="1">
								<p>Sets verbose mode.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>-j &lt;Path&gt; </p>
							</td>
							<td colspan="1">
								<p>Sets the log file location. The default is the current path.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>-t &lt;PortNumber&gt; </p>
							</td>
							<td colspan="1">
								<p>Specifies an LDAP port. The default LDAP port is 389. The global catalog port is 3268.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>-u</p>
							</td>
							<td colspan="1">
								<p>Specifies Unicode format.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>-d &lt;BaseDN&gt; </p>
							</td>
							<td colspan="1">
								<p>Sets the distinguished name of the search base for data export.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>-r &lt;LDAPFilter&gt; </p>
							</td>
							<td colspan="1">
								<p>Creates an LDAP search filter for data export. </p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>-p &lt;Scope&gt; </p>
							</td>
							<td colspan="1">
								<p>Sets the search scope. Search scope options are Base, OneLevel, or SubTree.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>-l &lt;LDAPAttributeList&gt; </p>
							</td>
							<td colspan="1">
								<p>Sets the list of attributes to return in the results of an export query. LDAP can return attributes in any order, and <b>csvde</b> does not attempt to impose any order on the columns. If you omit this parameter, AD DS returns all attributes. </p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>-o &lt;LDAPAttributeList&gt; </p>
							</td>
							<td colspan="1">
								<p>Specifies the list of attributes to omit from the results of an export query. You use this parameter if you need to export objects from AD DS, and then import them into another LDAP-compliant directory. If the other directory does not support certain attributes, you can use this parameter to omit those attributes from the result set.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>-g </p>
							</td>
							<td colspan="1">
								<p>Omits paged searches.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>-m </p>
							</td>
							<td colspan="1">
								<p>Omits attributes that apply only to Active Directory objects, such as the ObjectGUID, objectSID, pwdLastSet, and samAccountType attributes.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>-n </p>
							</td>
							<td colspan="1">
								<p>Omits the export of binary values.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>-k </p>
							</td>
							<td colspan="1">
								<p>Ignores errors during an import operation and continues processing. The following is a complete list of ignored errors: </p>
								<ul><li class="unordered">
										Object already exists <br><br>
									</li><li class="unordered">
										Constraint violation<br><br>
									</li><li class="unordered">
										Attribute or value already exists <br><br>
									</li></ul>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>-a [&lt;UserDistinguishedName&gt; {&lt;Password&gt; | *}] </p>
							</td>
							<td colspan="1">
								<p>Performs a simple LDAP bind with the user name and password. Sets the command to run using the supplied <i>UserDistinguishedName</i> and <i>Password</i>. By default, the command runs using the credentials of the user who is currently logged on to the network.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>-b [&lt;UserName&gt; &lt;Domain&gt; {&lt;Password&gt; | *}] </p>
							</td>
							<td colspan="1">
								<p>Performs a secure LDAP bind with the NEGOTIATE authentication method. Sets the command to run using the supplied <i>Username</i>, <i>Domain</i>, and <i>Password</i>. By default, the command will run using the credentials of the user who is currently logged on to the network. </p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>/? </p>
							</td>
							<td colspan="1">
								<p>Displays Help at the command prompt.</p>
							</td>
						</tr></table>
				</content></div><h2 class="heading">Remarks</h2><div id="sectionSection2" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<ul xmlns=""><li class="unordered">
							You cannot import user passwords by using <b>csvde</b> because passwords must be sent over an encrypted channel. <b>Csvde</b> does not support Secure Sockets Layer (SSL) or encrypted LDAP communication. The previous references to passwords relate to the credentials of the user who is running <b>csvde</b>. They are not related to setting passwords for users.<br><br>
						</li><li class="unordered">
							Applications such as Microsoft Excel spreadsheet software are capable of reading and saving data in the CSV format. You can also create CSV files using Notepad; separate the values that you add to your file with commas. In addition, the Microsoft Exchange Server administration tools are capable of importing and exporting data using the CSV format, as are many other from software developers other than Microsoft.<br><br>
							The CSV format consists of one or more lines of data with each value separated by a comma and no spaces between the comma and the next entry. The first line (sometimes referred to as the header) of the CSV file must contain the names of each attribute in the same order as the data in any line following the first line. For example:<br><br>
							<div class="code"><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>objectClass,dn,givenName,sn,samAccountName,Description
user,distinguishedName,1stUserFirstName,1stUserSurname,FirstUserLogonName,Manager
user,distinguishedName,2ndUserFirstName,2ndUserSurname,SecondUserLogonName,President</pre></td></tr></table></span></div>
						</li><li class="unordered">
							To see a list of properties that <b>csvde</b> can update, see the appropriate supported interfaces in ADSI Objects of LDAP (<a href="http://go.microsoft.com/fwlink/?LinkId=91123" alt="" target="_blank"><linktext xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">http://go.microsoft.com/fwlink/?LinkId=91123</linktext></a>). For example, to see the properties that can be set for Active Directory user objects, see IADsUser Interface (<a href="http://go.microsoft.com/fwlink/?LinkId=91124" alt="" target="_blank"><linktext xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">http://go.microsoft.com/fwlink/?LinkId=91124</linktext></a>), and then view Properties.<br><br>
						</li><li class="unordered">
							You can use <b>csvde -r</b> to create an LDAP search filter for data export. For example, the following filter exports all users with a particular surname:<br><br>
							<div class="code"><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>csvde -r (&amp;(objectClass=User)(sn=Surname))</pre></td></tr></table></span></div>
						</li></ul>
				</content></div><a name="BKMK_examples"></a><a name="bd5e4f88-c30a-47a8-b3d2-026e4497275c#BKMK_examples"></a><h2 class="heading">Examples</h2><div id="sectionSection3" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<p xmlns="">The following sample file contents are for a domain named Cpandl.com that has organizational units (OUs) named SW Dev, Acct, and AP. The AP OU is subordinate to the Acct OU. The first line of the file defines the Active Directory object properties for user accounts to be created by the entries in the rest of the file. The remaining lines are used to create the user accounts. The first user account is created in the default Users container, and the rest of the user accounts are created in the SW Dev, Acct, and AP OUs, respectively:</p>
					<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>objectClass,dn,sAMAccountName,userPrincipalName,userAccountControl
user,"CN=KMyer,CN=Users,DC=cpandl,DC=com",KenM,KenM@cpandl.com,514
user,"CN=WYu,OU=SW Dev,DC=cpandl,DC=com",WeiY,WeiY@cpandl.com,514
user,"CN=JMorris,OU=Acct,DC=cpandl,DC=com",JonM,JonM@cpandl.com,514
user,"CN=YXu,OU=AP,OU=Acct,DC=cpandl,DC=com",YeX,YeX@cpandl.com,514</pre></td></tr></table></span></div>
					<div class="alert" xmlns=""><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="../local/note.gif">Note </th></tr><tr><td>
						Setting <b>userAccountControl</b> to <b>514</b> disables the user account. This is recommended because <b>csvde</b> cannot set passwords.<p>
					</td></tr></table><p></div>
					<p xmlns="">The <b>-d</b> switch indicates the root (top) of a particular query. For example, if you want to export all the objects in the Marketing top-level OU of the Contoso.com domain to a file named marketingobjects.csv, you can use the following command:</p>
					<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>csvde -d "ou=marketing,dc=contoso,dc=com" -f marketingobjects.csv</pre></td></tr></table></span></div>
					<p xmlns="">The <b>-r</b> switch is a filter for exporting information from the directory. This switch filters the output that an export request produces. For example, if you want to export only the user account object attributes from a domain to a file named usersonly.csv, you can use the following command:</p>
					<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>csvde -r objectClass=user -f usersonly.csv</pre></td></tr></table></span></div>
					<p xmlns="">The following example exports Active Directory data to a file named search.txt, sets the search scope to subtree, and lists the <b>sAMAccountName</b>, <b>CN</b>, and <b>distinguished name </b>attributes for each object that is found in the search:</p>
					<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>csvde -f search.txt -p subtree -l SamAccountName,CN,Distinguishname</pre></td></tr></table></span></div>
					<p xmlns="">The following example imports the data from the current domain (the domain that you are logged on to) from a file named input.csv:</p>
					<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>csvde -i -f input.csv</pre></td></tr></table></span></div>
					<p xmlns="">The following example exports the data from the current domain (the domain that you are logged on to) to a file named output.csv:</p>
					<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>csvde -f output.csv</pre></td></tr></table></span></div>
					<p xmlns="">For additional examples using CSVDE, see article 327620 in the Microsoft Knowledge Base (<a href="http://go.microsoft.com/fwlink/?LinkId=91125" alt="" target="_blank"><linktext xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">http://go.microsoft.com/fwlink/?LinkId=91125</linktext></a>).</p>
				</content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
						</content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
							<h4 class="subHeading" xmlns="">Additional references</h4><div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
									<p xmlns="">
										<a href="338c0381-ad63-4a4c-bd2c-42c7a93821fe.htm">Command-Line Syntax Key</a>
									</p>
								</content></div>
						</sections></div>
				</sections></div><!--[if gte IE 5]>
			<tool:tip element="languageFilterToolTip" avoidmouse="false"/>
		<![endif]--></div><div id="footer"><hr><p></div></div></body></html>