<html dir="LTR" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:tool="http://www.microsoft.com/tooltip"><head><meta http-equiv="Content-Type" content="text/html; CHARSET=Windows-1252"><meta name="save" content="history"><title>Sc queryex</title><link rel="stylesheet" type="text/css" href="../local/Classic.css"><script src="../local/script.js"></script></head><body><div><input type="hidden" id="userDataCache" class="userDataStyle"><input type="hidden" id="hiddenScrollOffset"></div><img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif"><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif"><img id="collapseImage" style="display:none; height:0; width:0;" src="../local/collapse.gif"><img id="expandImage" style="display:none; height:0; width:0;" src="../local/exp.gif"><img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif"><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif"><div id="header"><table width="100%" id="topTable"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText"></span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Sc queryex</span></td></tr><tr id="headerTableRow3"><td></td></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p>Applies To: Windows Server 2008 R2,Windows Server 2008,Windows Server 2003 with SP1,Windows Server 2003,Windows Vista,Windows Server 2003 with SP2,Windows 7,Windows Server 2003 R2</p>
<p>Obtains and displays extended information about the specified service, driver, type of service, or type of driver.</p>

<p>For examples of how to use this command, see <a href="#BKMK_examples">Examples</a>.</p>
<h2 class="heading">Syntax</h2><div id="sectionSection0" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>sc [&lt;ServerName&gt;] queryex [type= {driver | service | all}] [type= {own | share | interact | kernel | filesys | rec | adapt}] [state= {active | inactive | all}] [bufsize= &lt;BufferSize&gt;] [ri= &lt;ResumeIndex&gt;][group= {"" | &lt;GroupName&gt;}]</pre></td></tr></table></span></div>
</content></div><h2 class="heading">Parameters</h2><div id="sectionSection1" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<h3 class="subHeading" xmlns=""></h3><table xmlns=""><tr>
<th colspan="1">
Parameter
</th>
<th colspan="1">
Description
</th></tr><tr>
<td colspan="1">
<p>&lt;ServerName&gt; </p>
</td>
<td colspan="1">
<p>Specifies the name of the remote server on which the service is located. The name must use the Universal Naming Convention (UNC) format (for example, \\myserver). To run SC.exe locally, omit this parameter.</p>
</td></tr><tr>
<td colspan="1">
<p>&lt;ServiceName&gt; </p>
</td>
<td colspan="1">
<p>Specifies the service name returned by the <b>getkeyname</b> operation. This <b>queryex</b> parameter is not used in conjunction with any other <b>queryex</b> parameters except <i>ServerName</i>.</p>
</td></tr><tr>
<td colspan="1">
<p>type= {driver | service | all} </p>
</td>
<td colspan="1">
<p>Specifies what to enumerate. The default value for the first type is <b>service</b>.</p>

<h3 class="subHeading"></h3><table><tr>
<th colspan="1">
Value
</th>
<th colspan="1">
Description
</th></tr><tr>
<td colspan="1">
<p>driver</p>
</td>
<td colspan="1">
<p>Specifies that only drivers are enumerated.</p>
</td></tr><tr>
<td colspan="1">
<p>service</p>
</td>
<td colspan="1">
<p>Specifies that only services are enumerated.</p>
</td></tr><tr>
<td colspan="1">
<p>all</p>
</td>
<td colspan="1">
<p>Specifies that both drivers and services are enumerated.</p>
</td></tr></table>
</td></tr><tr>
<td colspan="1">
<p>type= {own | share | interact | kernel | filesys | rec | adapt} </p>
</td>
<td colspan="1">
<p>Specifies the type of services or type of drivers to enumerate. The default value for the second type is <b>own</b>.</p>

<h3 class="subHeading"></h3><table><tr>
<th colspan="1">
Value
</th>
<th colspan="1">
Description
</th></tr><tr>
<td colspan="1">
<p>own</p>
</td>
<td colspan="1">
<p>The service runs in its own process. It does not share an executable file with other services. </p>
</td></tr><tr>
<td colspan="1">
<p>share</p>
</td>
<td colspan="1">
<p>The service runs as a shared process. It shares an executable file with other services.</p>
</td></tr><tr>
<td colspan="1">
<p>interact</p>
</td>
<td colspan="1">
<p>The service can interact with the desktop, receiving input from users. Interactive services must be run under the LocalSystem account.</p>
</td></tr><tr>
<td colspan="1">
<p>kernel</p>
</td>
<td colspan="1">
<p>Driver.</p>
</td></tr><tr>
<td colspan="1">
<p>filesys</p>
</td>
<td colspan="1">
<p>File system driver.</p>
</td></tr></table>
</td></tr><tr>
<td colspan="1">
<p>state= {active | inactive | all} </p>
</td>
<td colspan="1">
<p>Specifies the started state of the service for which to enumerate. The default state is <b>active</b>. </p>

<h3 class="subHeading"></h3><table><tr>
<th colspan="1">
Value
</th>
<th colspan="1">
Description
</th></tr><tr>
<td colspan="1">
<p>active</p>
</td>
<td colspan="1">
<p>Specifies all active services.</p>
</td></tr><tr>
<td colspan="1">
<p>inactive</p>
</td>
<td colspan="1">
<p>Specifies all paused or stopped services.</p>
</td></tr><tr>
<td colspan="1">
<p>all</p>
</td>
<td colspan="1">
<p>Specifies all services.</p>
</td></tr></table>
</td></tr><tr>
<td colspan="1">
<p>bufsize= &lt;BufferSize&gt; </p>
</td>
<td colspan="1">
<p>Specifies the size (in bytes) of the enumeration buffer. The default buffer size is 1024 bytes.</p>
</td></tr><tr>
<td colspan="1">
<p>ri= &lt;ResumeIndex&gt; </p>
</td>
<td colspan="1">
<p>Specifies the index number at which to begin or resume the enumeration. The default value is <b>0</b>.</p>
</td></tr><tr>
<td colspan="1">
<p>group= &lt;GroupName&gt; </p>
</td>
<td colspan="1">
<p>Specifies the service group to enumerate. By default, all groups are enumerated (<b>group= ""</b>).</p>
</td></tr><tr>
<td colspan="1">
<p>/? </p>
</td>
<td colspan="1">
<p>Displays help at the command prompt.</p>
</td></tr></table>
</content></div><h2 class="heading">Remarks</h2><div id="sectionSection2" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<ul xmlns=""><li class="unordered">
For each command-line option, the equal sign is part of the option name. <br><br>
</li><li class="unordered">
A space is required between an option and its value (for example, <b>type= own</b>. If the space is omitted, the operation will fail.<br><br>
</li><li class="unordered">
The <b>queryex</b> command displays the following information about a service: SERVICE_NAME (service's registry subkey name), TYPE, STATE (as well as states that are not available), WIN32_EXIT_B, SERVICE_EXIT_B, CHECKPOINT, WAIT_HINT, PID, and FLAGS.<br><br>
</li><li class="unordered">
You can use the <b>type=</b> parameter twice in some cases. The first appearance of the <b>type=</b> parameter specifies whether to query services, drivers, or both (<b>all</b>). The second appearance of the <b>type=</b> parameter specifies a type from the <b>create</b> operation to further narrow a query's scope.<br><br>
</li><li class="unordered">
When the display resulting from a <b>queryex</b> command exceeds the size of the enumeration buffer, a message similar to the following is displayed: <br><br>

<code>Enum: more data, need 2130 bytes start resume at index 75</code><br><br>

To display the remaining <b>queryex</b> information, rerun <b>queryex</b>, setting <b>bufsize=</b> to be the number of bytes and setting <b>ri=</b> to the specified index. For example, the remaining output would be displayed by typing the following at the command prompt:<br><br>

<div class="code"><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>sc queryex bufsize= 2130 ri= 75</pre></td></tr></table></span></div>
</li></ul>
</content></div><a name="BKMK_examples"></a><a name="5cea7dc1-8f47-4474-993d-94eb5d28e57e#BKMK_examples"></a><h2 class="heading">Examples</h2><div id="sectionSection3" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns="">To display extended information about the MESSENGER service, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>sc queryex messenger</pre></td></tr></table></span></div>

<p xmlns="">To display extended information about all service groups, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>sc queryex group= ""</pre></td></tr></table></span></div>
</content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"></content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<h4 class="subHeading" xmlns="">Additional references</h4><div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns=""><a href="338c0381-ad63-4a4c-bd2c-42c7a93821fe.htm">Command-Line Syntax Key</a></p>
</content></div>
</sections></div>
</sections></div><!--[if gte IE 5]>
			<tool:tip element="languageFilterToolTip" avoidmouse="false"/>
		<![endif]--></div><div id="footer"><hr><p></div></div></body></html>