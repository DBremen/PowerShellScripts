<html dir="LTR" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:tool="http://www.microsoft.com/tooltip"><head><meta http-equiv="Content-Type" content="text/html; CHARSET=Windows-1252"><meta name="save" content="history"><title>Prndrvr.vbs</title><link rel="stylesheet" type="text/css" href="../local/Classic.css"><script src="../local/script.js"></script></head><body><div><input type="hidden" id="userDataCache" class="userDataStyle"><input type="hidden" id="hiddenScrollOffset"></div><img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif"><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif"><img id="collapseImage" style="display:none; height:0; width:0;" src="../local/collapse.gif"><img id="expandImage" style="display:none; height:0; width:0;" src="../local/exp.gif"><img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif"><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif"><div id="header"><table width="100%" id="topTable"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText"></span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Prndrvr.vbs</span></td></tr><tr id="headerTableRow3"><td></td></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p>Applies To: Windows Server 2008,Windows Vista</p>
<p>Adds, deletes, and lists printer drivers. </p>

<p>For examples of how this command can be used, see <a href="#BKMK_examples">Examples</a>.</p>
<h2 class="heading">Syntax</h2><div id="sectionSection0" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>Cscript prndrvr {-a | -d | -l | -x | -?} [-m &lt;model&gt;] [-v {0|1|2|3}] <br>[-e &lt;environment&gt;] [-s &lt;ServerName&gt;] [-u &lt;UserName&gt;] [-w &lt;Password&gt;] <br>[-h &lt;path&gt;] [-i &lt;inf file&gt;]</pre></td></tr></table></span></div>
</content></div><h2 class="heading">Parameters</h2><div id="sectionSection1" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<h3 class="subHeading" xmlns=""></h3><table xmlns=""><tr>
<th colspan="1">
Parameter
</th>
<th colspan="1">
Description
</th></tr><tr>
<td colspan="1">
<p>-a</p>
</td>
<td colspan="1">
<p>Installs a driver.</p>
</td></tr><tr>
<td colspan="1">
<p>-d</p>
</td>
<td colspan="1">
<p>Deletes a driver.</p>
</td></tr><tr>
<td colspan="1">
<p>-l</p>
</td>
<td colspan="1">
<p>Lists all printer drivers installed on the server specified by the <b>-s</b> parameter. If you do not specify a server, Windows lists the printer drivers installed on the local computer.</p>
</td></tr><tr>
<td colspan="1">
<p>-x</p>
</td>
<td colspan="1">
<p>Deletes all printer drivers and additional printer drivers not in use by a logical printer on the server specified by the <b>-s</b> parameter. If you do not specify a server to remove from the list, Windows deletes all unused printer drivers on the local computer.</p>
</td></tr><tr>
<td colspan="1">
<p>-m &lt;DriverModelName&gt;</p>
</td>
<td colspan="1">
<p>Specifies (by name) the driver you want to install. Drivers are often named for the model of printer they support. See the printer documentation for more information.</p>
</td></tr><tr>
<td colspan="1">
<p>-v {0 | 1 | 2 | 3}</p>
</td>
<td colspan="1">
<p>Specifies the version of the driver you want to install. See the description of the <b>-e</b><b> </b>parameter for information on which versions are available for which environment. If you do not specify a version, the version of the driver appropriate for the version of Windows running on the computer where you are installing the driver is installed.</p>

<ul><li class="unordered">
Version <b>0</b> supports Windows 95, Windows 98, and Windows Millennium Edition.<br><br>
</li><li class="unordered">
Version <b>1</b> supports Windows NT 3.51.<br><br>
</li><li class="unordered">
Version <b>2</b> supports Windows NT 4.0.<br><br>
</li><li class="unordered">
Version <b>3</b> supports Windows Vista, Windows XP, Windows 2000, and the Windows Server 2003 operating systems. Note that this is the only printer driver version that Windows Vista supports.<br><br>
</li></ul>
</td></tr><tr>
<td colspan="1">
<p>-e &lt;Environment&gt;</p>
</td>
<td colspan="1">
<p>Specifies the environment for the driver you want to install. If you do not specify an environment, the environment of the computer where you are installing the driver is used. The supported environment parameters are:</p>

<ul><li class="unordered">
<b>"Windows NT x86"</b><br><br>
</li><li class="unordered">
<b>"Windows x64"</b><br><br>
</li><li class="unordered">
<b>"Windows IA64"</b><br><br>
</li></ul>
</td></tr><tr>
<td colspan="1">
<p>-s &lt;ServerName&gt;</p>
</td>
<td colspan="1">
<p>Specifies the name of the remote computer that hosts the printer that you want to manage. If you do not specify a computer, the local computer is used.</p>
</td></tr><tr>
<td colspan="1">
<p>-u &lt;UserName&gt; -w &lt;Password&gt;</p>
</td>
<td colspan="1">
<p>Specifies an account with permissions to connect to the computer that hosts the printer that you want to manage. All members of the target computer's local Administrators group have these permissions, but the permissions can also be granted to other users. If you do not specify an account, you must be logged on under an account with these permissions for the command to work. </p>
</td></tr><tr>
<td colspan="1">
<p>-h &lt;Path&gt;</p>
</td>
<td colspan="1">
<p>Specifies the path to the driver file. If you do not specify a path, the path to the location where Windows was installed is used.</p>
</td></tr><tr>
<td colspan="1">
<p>-i &lt;Filename.inf&gt;</p>
</td>
<td colspan="1">
<p>Specifies the complete path and file name for the driver you want to install. If you do not specify a file name, the script uses one of the inbox printer .inf files in the inf subdirectory of the Windows directory.</p>

<p>If the driver path is not specified, the script searches for driver files in the driver.cab file.</p>
</td></tr><tr>
<td colspan="1">
<p>/? </p>
</td>
<td colspan="1">
<p>Displays help at the command prompt.</p>
</td></tr></table>
</content></div><h2 class="heading">Remarks</h2><div id="sectionSection2" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<ul xmlns=""><li class="unordered">
The <b>Prndrvr.vbs</b> command is a Visual Basic script located in the %WINDIR%\System32\Printing_Admin_Scripts\&lt;language&gt; directory. To use this command, at a command prompt, type <b>Cscript</b> followed by the full path to the Prndrvr.vbs file, or change directories to the appropriate folder. For example:<br><br>

<div class="code"><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>Cscript %WINDIR%\System32\Printing_Admin_Scripts\en-US\Prndrvr.vbs</pre></td></tr></table></span></div>
</li><li class="unordered">
If the information that you supply contains spaces, use quotation marks around the text (for example, <code>"Computer Name"</code>).<br><br>
</li><li class="unordered">
The -x option deletes all additional printer drivers (drivers installed for use on clients running alternate versions of Windows), even if the primary driver is in use. If the fax component is installed, this option also deletes fax drivers. The primary fax driver is deleted if it is not in use (that is, if there is no queue using it). If the primary fax driver is deleted, the only way to re-enable fax is to reinstall the fax component.<br><br>
</li><li class="unordered">
Used without parameters, <b>Prndrvr.vbs</b> displays command-line help for the <b>Prndrvr.vbs</b> command.<br><br>
</li></ul>
</content></div><a name="BKMK_examples"></a><a name="82b09e3e-bd38-4df1-9953-b0e9ee2565a3#BKMK_examples"></a><h2 class="heading">Examples</h2><div id="sectionSection3" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns="">To list all drivers on the \\PrintServer1 server, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>Cscript Prndrvr -l -s</pre></td></tr></table></span></div>

<p xmlns="">To add a version 3 Windows x64 printer driver for the "Laser Printer Model 1" model of printer using the C:\temp\LaserPrinter1.inf driver information file for a driver stored in the C:\temp folder type: </p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>Cscript Prndrvr -a -m "Laser Printer Model 1" -v 3 -e "Windows x64" -i c:\temp\LaserPrinter1.inf -h c:\temp</pre></td></tr></table></span></div>

<p xmlns="">To delete a version 3 Windows NT x86 printer driver for "Laser Printer Model 1", type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>Cscript Prndrvr -a -m "Laser Printer Model 1" -v 3 -e "Windows NT x86" </pre></td></tr></table></span></div>
</content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"></content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<h4 class="subHeading" xmlns="">Additional references</h4><div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns=""><a href="338c0381-ad63-4a4c-bd2c-42c7a93821fe.htm">Command-Line Syntax Key</a></p>

<p xmlns=""><a href="88d8fa87-6fa8-4774-9294-080b0157ea8d.htm">Print Command Reference</a></p>
</content></div>
</sections></div>
</sections></div><!--[if gte IE 5]>
			<tool:tip element="languageFilterToolTip" avoidmouse="false"/>
		<![endif]--></div><div id="footer"><hr><p></div></div></body></html>