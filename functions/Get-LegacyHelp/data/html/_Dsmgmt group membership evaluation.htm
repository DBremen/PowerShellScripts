<html dir="LTR" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:tool="http://www.microsoft.com/tooltip"><head><meta http-equiv="Content-Type" content="text/html; CHARSET=Windows-1252"><meta name="save" content="history"><title>group membership evaluation</title><link rel="stylesheet" type="text/css" href="../local/Classic.css"><script src="../local/script.js"></script></head><body><div><input type="hidden" id="userDataCache" class="userDataStyle"><input type="hidden" id="hiddenScrollOffset"></div><img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif"><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif"><img id="collapseImage" style="display:none; height:0; width:0;" src="../local/collapse.gif"><img id="expandImage" style="display:none; height:0; width:0;" src="../local/exp.gif"><img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif"><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif"><div id="header"><table width="100%" id="topTable"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText"></span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">group membership evaluation</span></td></tr><tr id="headerTableRow3"><td></td></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p>Applies To: Windows Server 2003,Windows Server 2003,Windows Server 2003 R2,Windows Server 2003 R2,Windows Server 2008,Windows Server 2008,Windows Server 2003 with SP1,Windows Server 2003 with SP1</p>
				<p>Generates a report with information about group memberships for a user. Active Directory environments that contain complex group structures can encounter problems with access token limitation during authentication. This problem can result in the inability of a user to log on or access resources. By analyzing the results of the report, you can identify the source of the problem.</p>
				<p>For detailed information about the access token limitation issue and how to use the <code>group membership evaluation</code> option in Ntdsutil or Dsmgmt to resolve related problems, see <a href="http://go.microsoft.com/fwlink/?LinkId=62237" alt="" target="_blank"><linktext xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Addressing Problems Due to Access Token Limitation</linktext></a> (http://go.microsoft.com/fwlink/?LinkId=62237).</p>
				<p>This is a subcommand of Ntdsutil and Dsmgmt. Ntdsutil and Dsmgmt are command-line tools that are built into Windows Server 2008 and Windows Server 2008 R2. Ntdsutil is available if you have the Active Directory Domain Services (AD DS) or Active Directory Lightweight Directory Services (AD LDS) server role installed. Dsmgmt is available if you have the AD LDS server role installed. These tools are also available if you install the Active Directory Domain Services Tools that are part of the Remote Server Administration Tools (RSAT). For more information, see <a href="http://go.microsoft.com/fwlink/?LinkID=177813" alt="" target="_blank"><linktext xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">How to Administer Microsoft Windows Client and Server Computers Locally and Remotely</linktext></a> (http://go.microsoft.com/fwlink/?LinkID=177813).</p>
				<p>To use either of these tools, you must run them from an elevated command prompt. To open an elevated command prompt, click <b>Start</b>, right-click <b>Command Prompt</b>, and then click <b>Run as administrator</b>.</p>
				<p>For examples of how to use this command, see <a href="#BKMK_examples">Examples</a>.</p>
			<h2 class="heading">Syntax</h2><div id="sectionSection0" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>[clear credentials] [run %s1 %s2] [set account dc %s] [set credentials %s1 %s2 %s3] [set global catalog %s] [set resource dc %s] [verbose %s]</pre></td></tr></table></span></div>
				</content></div><h2 class="heading">Parameters</h2><div id="sectionSection1" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<h3 class="subHeading" xmlns=""></h3><table xmlns=""><tr>
								<th colspan="1">
									Parameter
								</th>
								<th colspan="1">
									Description
								</th>
							</tr><tr>
							<td colspan="1">
								<p>clear credentials</p>
							</td>
							<td colspan="1">
								<p>Clears credentials that were used for a prior connection. </p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>run %s1 %s2</p>
							</td>
							<td colspan="1">
								<p>Runs token evaluation for the principal %s2 in domain %s1.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>set account dc %s</p>
							</td>
							<td colspan="1">
								<p>Specifies the domain controller used in the account domain. The account domain is the domain that includes the user account. If you do not specify a domain controller, the tool automatically locates one.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>set credentials %s1 %s2 %s3</p>
							</td>
							<td colspan="1">
								<p>Sets connection credentials as domain %s1, user %s2, and password %s3. </p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>set global catalog %s</p>
							</td>
							<td colspan="1">
								<p>Specifies which global catalog server to use. If you do not specify a global catalog, ntdsutil.exe automatically locates one.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>set resource dc %s</p>
							</td>
							<td colspan="1">
								<p>Specifies the domain controller used in the resource domain. Use this parameter only if the user and computer on which the logon is being attempted are in different domains. If the user and computer belong to different domains, the resource groups of the computer must also be enumerated.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>verbose %s</p>
							</td>
							<td colspan="1">
								<p>Turns verbose mode on or off.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>quit</p>
							</td>
							<td colspan="1">
								<p>Takes you back to the previous menu, or exits the utility.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>?</p>
							</td>
							<td colspan="1">
								<p>Displays Help at the command prompt.</p>
							</td>
						</tr><tr>
							<td colspan="1">
								<p>Help</p>
							</td>
							<td colspan="1">
								<p>Displays Help at the command prompt.</p>
							</td>
						</tr></table>
				</content></div><h2 class="heading">Remarks</h2><div id="sectionSection2" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<ul xmlns=""><li class="unordered">
							If the variable has spaces in it, enclose it in parentheses, instead of quotation marks: <b>connect to server (</b><i>xxx yyy</i><b>)</b>.<br><br>
						</li><li class="unordered">
							
								Ntdsutil does not correctly handle special characters, such as the apostrophe character ('), that you can enter at the <b>ntdsutil:</b> prompt at the command line. In some situations, there may be an alternative workaround. For more information, see <a href="http://go.microsoft.com/fwlink/?LinkId=157320" alt="" target="_blank"><maml:linktext xmlns:maml="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">local roles</maml:linktext></a> (http://go.microsoft.com/fwlink/?LinkId=157320).
							<br><br>
						</li></ul>
				</content></div><a name="BKMK_examples"></a><a name="dc3722d8-b6de-4863-b456-1b17139caa42#BKMK_examples"></a><h2 class="heading">Examples</h2><div id="sectionSection3" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<p xmlns="">If you want to evaluate the group memberships for a user with SAM Account Name ToniPoe in a domain named corp.cpandl.com, using Ntdsutil you can do the following:</p>
					<ol class="ordered" xmlns=""><li>At the <code>ntdsutil:</code> prompt, type <code>group membership evaluation</code>, and then press ENTER.<br><br></li><li>Type <code>set account dc</code> &lt;dcname&gt;, where &lt;dcname&gt; is the actual name of a domain controller in your domain that you want to use to obtain the accounts global group memberships, and then press ENTER.<br><br></li><li>Type <code>set globcal catalog</code> &lt;gcname&gt;, where &lt;gcname&gt; is the actual name of a domain controller in your domain acting as a global catalog server that you want to use to obtain the accounts universal group memberships, and then press ENTER.<br><br></li><li>Type <code>set resource dc</code> &lt;dcname&gt;, where &lt;dcname&gt; is the actual name of a domain controller in your domain that you want to use to obtain the accounts local group memberships, and then press ENTER.<br><br></li><li>Type <code>run corp.cpandl.com tonipoe</code>, and then press ENTER.<br><br></li><li>Ntdsutil outputs a tab-separated-value file (.tsv) with a specific name. That file is located in the folder from which you started Ntdsutil. The file name is reported by Ntdsutil. To access the file, type <code>quit</code>, and then press ENTER twice.<br><br></li><li>Type <code>dir *.tsv</code> to see a list of the tab-separated-value files in the current folder.<br><br></li><li>You can open the file in a spreadsheet program or a text file viewer. For example, to open a file named tonipoe-20090514203117.tsv in Notepad, type <code>notepad tonipoe-20090514203117.tsv</code>, and then press ENTER.<br><br></li></ol>
				</content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
					<div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
						</content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
							<h4 class="subHeading" xmlns="">Additional references</h4><div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
									<p xmlns="">
										<a href="338c0381-ad63-4a4c-bd2c-42c7a93821fe.htm">Command-Line Syntax Key</a>
									</p>
									<p xmlns="">
										<a href="199cebb9-967c-4307-a9d7-1c0bb50dc75b.htm">Ntdsutil</a>
									</p>
<p xmlns=""><a href="c525f20d-fdcf-4da8-8450-cce9988bc811.htm">Dsmgmt</a></p><p xmlns=""><a href="b5416510-9aa5-44e4-8b4b-279dee264183.htm">authoritative restore</a></p><p xmlns=""><a href="f27dc4c0-0623-401b-b411-48acf995f595.htm">configurable settings</a></p><p xmlns=""><a href="baa9c5e1-0c26-4d57-8ca9-ff5b15c33d29.htm">DS behavior</a></p><p xmlns=""><a href="594c47bc-095d-465e-b7cb-3f0234350460.htm">files</a></p><p xmlns=""><a href="c705e804-97d5-4a15-8d60-1ba09e5544e6.htm">ifm</a></p><p xmlns=""><a href="309950c8-5bfa-4b9e-b4a2-706ac63948ec.htm">LDAP policies</a></p><p xmlns=""><a href="aee69f2f-49bf-49cb-ac0b-eccc26423b1f.htm">local roles</a></p><p xmlns=""><a href="8ff66708-2ad0-4f52-982d-376a50a0e2dd.htm">metadata cleanup</a></p><p xmlns=""><a href="8ee336a2-b784-4743-8500-8d224a372110.htm">partition management</a></p><p xmlns=""><a href="f74c0470-3b2d-422c-bbbc-385cf39ec175.htm">roles</a></p><p xmlns=""><a href="1a4153d9-eb6e-4c50-8063-eb4ce961c32c.htm">security account management</a></p><p xmlns=""><a href="16b6f806-20b9-47bd-92c5-5cd96645c3bf.htm">semantic database analysis</a></p><p xmlns=""><a href="66fbd855-b3ee-434f-b890-c96858da8178.htm">set DSRM password</a></p><p xmlns=""><a href="a4b0e355-cbd0-4f48-9484-877fad1789ec.htm">snapshot</a></p></content></div>
						</sections></div>
				</sections></div><!--[if gte IE 5]>
			<tool:tip element="languageFilterToolTip" avoidmouse="false"/>
		<![endif]--></div><div id="footer"><hr><p></div></div></body></html>