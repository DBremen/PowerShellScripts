<html dir="LTR" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:tool="http://www.microsoft.com/tooltip"><head><meta http-equiv="Content-Type" content="text/html; CHARSET=Windows-1252"><meta name="save" content="history"><title>Creating a task for File Server Resource Manager reports by using the schtasks command</title><link rel="stylesheet" type="text/css" href="../local/Classic.css"><script src="../local/script.js"></script></head><body><div><input type="hidden" id="userDataCache" class="userDataStyle"><input type="hidden" id="hiddenScrollOffset"></div><img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif"><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif"><img id="collapseImage" style="display:none; height:0; width:0;" src="../local/collapse.gif"><img id="expandImage" style="display:none; height:0; width:0;" src="../local/exp.gif"><img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif"><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif"><div id="header"><table width="100%" id="topTable"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText"></span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Creating a task for File Server Resource Manager reports by using the schtasks command</span></td></tr><tr id="headerTableRow3"><td></td></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p>Applies To: Windows Server 2008,Windows Server 2008 R2</p>
<p>Before you can schedule a storage report by using the <a href="4433454c-daa9-4b7a-befd-9b11d46daffa.htm">Storrept</a> command-line tool for File Server Resource Manager, you must first create a task on the computer that will be generating the report. You can create this task by using the <b>schtasks</b> command, which is available by default in Windows Server 2008.</p>

<p>This topic explains how to create a task that can be used to schedule a File Server Resource Manager storage report. For an example of how to use the <b>schtasks</b> and <b>storrept</b> commands to schedule a storage report task, see <a href="#BKMK_examples">Example</a>.</p>
<h2 class="heading">About the schtasks command</h2><div id="sectionSection0" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns="">The <b>schtasks</b> command helps you create and manage common tasks that your computer will carry out automatically at the times that you specify. Using <b>schtasks</b>, you can schedule programs and other commands to run periodically or at a specific time. Note that this command-line tool performs the same operations as <b>Task Scheduler</b> in <b>Administrative Tools</b>.</p>

<p xmlns="">For more information about the <b>schtasks</b> command, see <a href="2e713203-3dd8-491b-b9e1-9423618dc7e8.htm">Schtasks</a>.</p>
</content></div><h2 class="heading">Creating a task to generate a storage report</h2><div id="sectionSection1" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns="">You can create new tasks by using the <b>/create</b> parameter with the <b>schtasks</b> command.</p>

<p xmlns="">To perform this procedure, you must have membership in <b>Administrators</b>, or you must have been delegated the appropriate authority.</p>

<h4 class="subHeading" xmlns=""><b>To create a task that generates a storage report</b></h4><div class="subSection" xmlns=""><ddue:steps xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"><ol class="ordered" xmlns=""><li><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns="">Open an elevated Command Prompt window. (Click <b>Start</b>, point to <b>All Programs</b>, click <b>Accessories</b>, right-click <b>Command Prompt</b>, and then click <b>Run as administrator</b>.)</p>
</content></li><li><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns="">To create the new task, type:</p>

<p xmlns=""><b>schtasks /create /sc </b>&lt;Schedule&gt;<b> /tn </b>&lt;TaskName&gt;<b> /tr "storrept reports generate /scheduled /task:</b>&lt;TaskName&gt;<b>" /v1 /st </b>&lt;Time&gt;<b> /ru system</b></p>

<p xmlns="">where:</p>

<ul xmlns=""><li class="unordered">
<i>Schedule</i> specifies the schedule type. Valid values are <b>minute</b>, <b>hourly</b>, <b>daily</b>, <b>weekly</b>, <b>monthly</b>, <b>once</b>, <b>onstart</b>, <b>onlogon</b>, and <b>onidle</b>. For more information about these values, see <a href="2e713203-3dd8-491b-b9e1-9423618dc7e8.htm">Schtasks</a>.<br><br>
</li><li class="unordered">
<i>TaskName</i> is the name that you want to give the task. Each task on the system must have a unique name. Use quotation marks to enclose names that include spaces.<br><br>
</li><li class="unordered">
<i>Time</i> specifies the time of day at which you want the report to be generated. The time format is based on 24-hour time (hh:mm). For example, type 14:30 if you want the report to be generated at 2:30 p.m.. If you do not use the <b>/st</b> parameter, the current time will be used for the scheduling of the task.<br><br>
</li></ul>
</content></li></ol></ddue:steps><conclusion xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"><content>
<div class="alert" xmlns=""><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="../local/Important.gif">Important </th></tr><tr><td>
You must include both the <b>/scheduled</b> parameter for the <b>storrept</b> command and the <b>/v1</b> parameter for the <b>schtasks</b> command. Without these parameters, the storage report task will not run successfully.<p>
</td></tr></table><p></div>

<div class="alert" xmlns=""><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="../local/note.gif">Note </th></tr><tr><td>
When specifying a time for the task to run, consider choosing a time of day when your server is less busy. This will ensure minimal impact on system performance.<p>
</td></tr></table><p></div>

<div class="alert" xmlns=""><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="../local/note.gif">Note </th></tr><tr><td>
There are other optional parameters that you can use with the <b>/create</b> parameter of the <b>schtasks</b> command. Those parameters enable you to create more complex schedules and manage how the storage report task will run. For more information, see <a href="2e713203-3dd8-491b-b9e1-9423618dc7e8.htm">Schtasks</a>.<p>
</td></tr></table><p></div>
</content></conclusion></div>
</content></div><h2 class="heading">Adding a storage report to a scheduled task</h2><div id="sectionSection2" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns="">After the task has been successfully created, you can use the <a href="4a1537e4-e4a7-458d-8def-70acf1398cc6.htm">Storrept reports add</a> command to specify the report that will be generated when the scheduled task runs. You can also use the <a href="1b51efc8-3bb2-49ef-bbf5-14beeaa7c6be.htm">Storrept reports modify</a> command to add more than one report to the same task.</p>
</content></div><a name="BKMK_examples"></a><a name="8f463192-1399-4224-ae73-234a3bd06e29#BKMK_examples"></a><h2 class="heading">Example</h2><div id="sectionSection3" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns="">To create a new task named FSRMReport that will run daily at 1:00 a.m., type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>schtasks /create /sc daily /tn fsrmreport /tr "storrept reports generate /scheduled /task:fsrmreport" /v1 /st 01:00 /ru system</pre></td></tr></table></span></div>

<p xmlns="">After the FSRMReport task has been successfully created, to add to the task a Quota Usage report for volumes C: and D: in HTML format, and have the report sent to the admin@contoso.com and storage.quota@contoso.com e-mail addresses, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>storrept reports add /task:fsrmreport /scope:"c:\|d:\" /add-report:quotausage /format:"html" /mailto:admin@contoso.com;storage.quota@contoso.com</pre></td></tr></table></span></div>

<p xmlns="">To add the File Screen Auditing report to the same FSRMReport task so that both this report and the Quota Usage report are generated when the task runs, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>storrept reports modify /task:fsrmreport /add-report:filescreenaudit</pre></td></tr></table></span></div>
</content></div><!--[if gte IE 5]>
			<tool:tip element="languageFilterToolTip" avoidmouse="false"/>
		<![endif]--></div><div id="footer"><hr><p></div></div></body></html>