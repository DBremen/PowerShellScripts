<html dir="LTR" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:tool="http://www.microsoft.com/tooltip"><head><meta http-equiv="Content-Type" content="text/html; CHARSET=Windows-1252"><meta name="save" content="history"><title>Runas</title><link rel="stylesheet" type="text/css" href="../local/Classic.css"><script src="../local/script.js"></script></head><body><div><input type="hidden" id="userDataCache" class="userDataStyle"><input type="hidden" id="hiddenScrollOffset"></div><img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif"><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif"><img id="collapseImage" style="display:none; height:0; width:0;" src="../local/collapse.gif"><img id="expandImage" style="display:none; height:0; width:0;" src="../local/exp.gif"><img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif"><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif"><div id="header"><table width="100%" id="topTable"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText"></span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Runas</span></td></tr><tr id="headerTableRow3"><td></td></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p>Applies To: Windows Server 2008,Windows HPC Server 2008 R2,Windows XP,Windows Server 2003 with SP1,Windows Vista,Windows Server 2003,Windows Server 2000,Windows Server 2003 R2,Windows 7</p>
<p>Allows a user to run specific tools and programs with different permissions than the user's current logon provides. </p>

<p><b>Runas</b> is a command-line tool that is built into Windows Vista. To use <b>runas</b> at the command line, open a command prompt, type <b>runas</b> with the appropriate parameters, and then press ENTER. </p>

<p>In the user interface for Windows Vista, the <b>Run as…</b> command has been changed to <b>Run as administrator</b>. However, you should rarely have to use the <b>Run as administrator</b> command because Windows Vista will automatically prompt you for an administrator password when it is needed.</p>

<p>For examples of how this command can be used, see <a href="#BKMK_examples">Examples</a>.</p>
<h2 class="heading">Syntax</h2><div id="sectionSection0" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>runas [{/profile | /noprofile}] [/env] [{/netonly | /savecred}] [/smartcard] [/showtrustlevels] [/trustlevel] /user:&lt;UserAccountName&gt; "&lt;ProgramName&gt; &lt;PathToProgramFile&gt;"</pre></td></tr></table></span></div>
</content></div><h2 class="heading">Parameters</h2><div id="sectionSection1" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<h3 class="subHeading" xmlns=""></h3><table xmlns=""><tr>
<th colspan="1">
Parameter
</th>
<th colspan="1">
Description
</th></tr><tr>
<td colspan="1">
<p><b>/profile </b></p>
</td>
<td colspan="1">
<p>Loads the user's profile. This is the default. This parameter cannot be used with the <b>/netonly</b> parameter.</p>
</td></tr><tr>
<td colspan="1">
<p><b>/no profile </b></p>
</td>
<td colspan="1">
<p>Specifies that the user's profile is not to be loaded. This allows the application to load more quickly, but it can also cause a malfunction in some applications.</p>
</td></tr><tr>
<td colspan="1">
<p><b>/env </b></p>
</td>
<td colspan="1">
<p>Specifies that the current network environment be used instead of the user's local environment.</p>
</td></tr><tr>
<td colspan="1">
<p><b>/netonly </b></p>
</td>
<td colspan="1">
<p>Indicates that the user information specified is for remote access only. This parameter cannot be used with the <b>/profile</b> parameter.</p>
</td></tr><tr>
<td colspan="1">
<p><b>/savecred </b></p>
</td>
<td colspan="1">
<p>Indicates if the credentials have been previously saved by this user. This parameter is not available and will be ignored on Windows Vista Home or Windows Vista Starter Editions. This parameter cannot be used with the <b>/smartcard</b> parameter.</p>
</td></tr><tr>
<td colspan="1">
<p><b>/smartcard </b></p>
</td>
<td colspan="1">
<p>Indicates whether the credentials are to be supplied from a smartcard. This parameter cannot be used with the <b>/savecred</b> parameter.</p>
</td></tr><tr>
<td colspan="1">
<p><b>/showtrustlevels </b></p>
</td>
<td colspan="1">
<p>Displays the trust levels that can be used as arguments to <b>/trustlevel</b>.</p>
</td></tr><tr>
<td colspan="1">
<p><b>/trustlevel </b></p>
</td>
<td colspan="1">
<p>Specifies the level of authorization at which the application is to run. Use <b>/showtrustlevels</b> to see the trust levels available. </p>
</td></tr><tr>
<td colspan="1">
<p><b>/user:&lt;</b>UserAccountName&gt; <b>"&lt;</b>ProgramName&gt; &lt;PathToProgramFile&gt;<b>"</b></p>
</td>
<td colspan="1">
<p>Specifies the name of the user account under which to run the program, the program name, and the path to the program file. The user account name format should be &lt;User&gt;<b>@&lt;</b>Domain&gt; or &lt;Domain&gt;<b>\&lt;</b>UserAccountName&gt;.</p>
</td></tr><tr>
<td colspan="1">
<p><b>/? </b></p>
</td>
<td colspan="1">
<p>Displays help at the command prompt.</p>
</td></tr></table>
</content></div><h2 class="heading">Remarks</h2><div id="sectionSection2" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<ul xmlns=""><li class="unordered">
Enter the user's password only when prompted.<br><br>
</li><li class="unordered">
It is good practice for administrators to use an account with restrictive permissions to perform routine, nonadministrative tasks, and to use an account with broader permissions only when performing specific administrative tasks. To accomplish this without logging off and back on, log on with a regular user account, and then use the <b>runas</b> command to run the tools that require the broader permissions.     <br><br>
</li><li class="unordered">
The use of <b>runas</b> is not restricted to administrator accounts, although that is the most common use. Any user with multiple accounts can use <b>runas</b> to run a program, MMC console, or Control Panel item with alternate credentials.<br><br>
</li><li class="unordered">
If you want to use the Administrator account on your computer, for the <b>/user:</b> parameter, type one of the following: <br><br>

<b>/user:&lt;</b>AdministratorAccountName&gt;@&lt;ComputerName&gt;<br><br>

<b>/user:&lt;</b>ComputerName&gt;<b>\&lt;</b>AdministratorAccountName&gt;<br><br>
</li><li class="unordered">
If you want to use this command as a domain administrator, type one of the following: <br><br>

<b>/user:&lt;</b>AdministratorAccountName&gt;<b>@&lt;</b>DomainName&gt;<br><br>

<b>/user:&lt;</b>DomainName&gt;\&lt;AdministratorAccountName&gt;<br><br>
</li><li class="unordered">
With the <b>runas</b> command, you can run programs (*.exe), saved MMC consoles (*.msc), shortcuts to programs and saved MMC consoles, and Control Panel items. You can run them as an administrator while you are logged on to your computer as a member of another group, such as the Users or Power Users group.<br><br>
</li><li class="unordered">
You can use the <b>runas</b> command to start any program, MMC console, or Control Panel item. As long as you provide the appropriate user account and password information, the user account has the ability to log on to the computer, and the program, MMC console, or Control Panel item is available on the system and to the user account.<br><br>
</li><li class="unordered">
With the <b>runas</b> command, you can administer a server in another domain or forest (the computer from which you run a tool and the server you administer are in different domains or forests).<br><br>
</li><li class="unordered">
If you try to start a program, MMC console, or Control Panel item from a network location using <b>runas</b>, it might fail because the credentials used to connect to the shared network resource are different from the credentials used to start the program. The latter credentials may not be able to gain access to the same shared network resource.<br><br>
</li><li class="unordered">
Some items, such as the Printers folder and desktop items, are opened indirectly and cannot be started with the <b>runas</b> command.<br><br>
</li><li class="unordered">
If the <b>runas</b> command fails, the <b>Secondary Logon</b> service might not be running or the user account you are using might not be valid. To check the status of the <b>Secondary Logon</b> service, in Computer Management, click <b>Services and Applications</b>, and then click <b>Services</b>. To test the user account, try logging on to the appropriate domain using the account.<br><br>
</li></ul>
</content></div><a name="BKMK_examples"></a><a name="7b710f79-d28a-4297-b5fc-0c1868d236fc#BKMK_examples"></a><h2 class="heading">Examples</h2><div id="sectionSection3" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns="">The following command starts an instance of the command prompt as an administrator on the local computer:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>runas /user:&lt;localmachinename&gt;\administrator cmd</pre></td></tr></table></span></div>

<p xmlns="">When prompted, type the administrator account password.</p>

<p xmlns="">The following command starts an instance of the Computer Management snap-in using a domain administrator account called contoso\domainadmin:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>runas /user:contoso\domainadmin "mmc %windir%\system32\compmgmt.msc"</pre></td></tr></table></span></div>

<p xmlns="">When prompted, type the domain administrator account password.</p>

<p xmlns="">The following command starts an instance of Notepad (and a file named my_file.txt) using a domain administrator account called jayj in a domain called domain.contoso.com:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>runas /user:jayj@domain.contoso.com "notepad my_file.txt"</pre></td></tr></table></span></div>

<p xmlns="">When prompted, type the domain administrator account password.</p>

<p xmlns="">The following command starts an instance of a command prompt window, saved MMC console, Control Panel item, or program that will administer a server in another forest:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>runas /netonly /user:&lt;Domain&gt;\&lt;User_Name&gt; "&lt;Command&gt;"</pre></td></tr></table></span></div>

<p xmlns="">&lt;Domain&gt;\&lt;User_Name&gt; must be a user with sufficient permissions to administer the server. When prompted, type the account password.</p>
</content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"></content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<h4 class="subHeading" xmlns="">Additional references</h4><div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns=""><a href="338c0381-ad63-4a4c-bd2c-42c7a93821fe.htm">Command-Line Syntax Key</a></p>
</content></div>
</sections></div>
</sections></div><!--[if gte IE 5]>
			<tool:tip element="languageFilterToolTip" avoidmouse="false"/>
		<![endif]--></div><div id="footer"><hr><p></div></div></body></html>