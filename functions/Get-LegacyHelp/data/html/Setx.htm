<html dir="LTR" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:tool="http://www.microsoft.com/tooltip"><head><meta http-equiv="Content-Type" content="text/html; CHARSET=Windows-1252"><meta name="save" content="history"><title>Setx</title><link rel="stylesheet" type="text/css" href="../local/Classic.css"><script src="../local/script.js"></script></head><body><div><input type="hidden" id="userDataCache" class="userDataStyle"><input type="hidden" id="hiddenScrollOffset"></div><img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif"><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif"><img id="collapseImage" style="display:none; height:0; width:0;" src="../local/collapse.gif"><img id="expandImage" style="display:none; height:0; width:0;" src="../local/exp.gif"><img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif"><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif"><div id="header"><table width="100%" id="topTable"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText"></span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Setx</span></td></tr><tr id="headerTableRow3"><td></td></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p>Applies To: Windows Server 2008,Windows Vista</p>
<p>Creates or modifies environment variables in the user or system environment, without requiring programming or scripting. The <b>Setx</b> command also retrieves the values of registry keys and writes them to text files.</p>

<p>For examples of how to use this command, see <a href="#BKMK_examples">Examples</a>.</p>
<h2 class="heading">Syntax</h2><div id="sectionSection0" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>setx [/s &lt;Computer&gt; [/u [&lt;Domain&gt;\]&lt;User name&gt; [/p [&lt;Password&gt;]]]] &lt;Variable&gt; &lt;Value&gt; [/m]
setx [/s &lt;Computer&gt; [/u [&lt;Domain&gt;\]&lt;User name&gt; [/p [&lt;Password&gt;]]]] [&lt;Variable&gt;] /k &lt;Path&gt; [/m]
setx [/s &lt;Computer&gt; [/u [&lt;Domain&gt;\]&lt;User name&gt; [/p [&lt;Password&gt;]]]] /f &lt;FileName&gt; {[&lt;Variable&gt;] {/a &lt;X&gt;,&lt;Y&gt; | /r &lt;X&gt;,&lt;Y&gt; "&lt;String&gt;"} [/m] | /x} [/d &lt;Delimiters&gt;]</pre></td></tr></table></span></div>
</content></div><h2 class="heading">Parameters</h2><div id="sectionSection1" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<h3 class="subHeading" xmlns=""></h3><table xmlns=""><tr>
<th colspan="1">
Parameter
</th>
<th colspan="1">
Description
</th></tr><tr>
<td colspan="1">
<p>/s &lt;Computer&gt; </p>
</td>
<td colspan="1">
<p>Specifies the name or IP address of a remote computer. Do not use backslashes. The default value is the name of the local computer. </p>
</td></tr><tr>
<td colspan="1">
<p>/u [&lt;Domain&gt;\]&lt;User name&gt;</p>
</td>
<td colspan="1">
<p>Runs the script with the credentials of the specified user account. The default value is the system permissions.</p>
</td></tr><tr>
<td colspan="1">
<p>/p [&lt;Password&gt;] </p>
</td>
<td colspan="1">
<p>Specifies the password of the user account that is specified in the <b>/u</b> parameter.</p>
</td></tr><tr>
<td colspan="1">
<p>&lt;Variable&gt; </p>
</td>
<td colspan="1">
<p>Specifies the name of the environment variable that you want to set.</p>
</td></tr><tr>
<td colspan="1">
<p>&lt;Value&gt; </p>
</td>
<td colspan="1">
<p>Specifies the value to which you want to set the environment variable.</p>
</td></tr><tr>
<td colspan="1">
<p>/k &lt;Path&gt; </p>
</td>
<td colspan="1">
<p>Specifies that the variable is set based on information from a registry key. The p<i>ath</i> uses the following syntax:</p>

<p><code>\&lt;HIVE&gt;\&lt;KEY&gt;\...\&lt;Value&gt;</code> </p>

<p>For example, you might specify the following path: </p>

<p><code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\TimeZoneInformation\StandardName</code></p>
</td></tr><tr>
<td colspan="1">
<p>/f &lt;File name&gt; </p>
</td>
<td colspan="1">
<p>Specifies the file that you want to use.</p>
</td></tr><tr>
<td colspan="1">
<p>/a &lt;X&gt;,&lt;Y&gt; </p>
</td>
<td colspan="1">
<p>Specifies absolute coordinates and offset as search parameters.</p>
</td></tr><tr>
<td colspan="1">
<p>/r &lt;X&gt;,&lt;Y&gt; "&lt;String&gt;" </p>
</td>
<td colspan="1">
<p>Specifies relative coordinates and offset from <b>String</b> as search parameters.</p>
</td></tr><tr>
<td colspan="1">
<p>/m </p>
</td>
<td colspan="1">
<p>Specifies to set the variable in the system environment. The default setting is the local environment. </p>
</td></tr><tr>
<td colspan="1">
<p>/x </p>
</td>
<td colspan="1">
<p>Displays file coordinates, ignoring the <b>/a</b>, <b>/r</b>, and <b>/d</b> command-line options.</p>
</td></tr><tr>
<td colspan="1">
<p>/d &lt;Delimiters&gt; </p>
</td>
<td colspan="1">
<p>Specifies delimiters such as "<b>,</b>" or "<b>\</b>" to be used in addition to the four built-in delimiters — SPACE, TAB, ENTER, and LINEFEED. Valid delimiters include any ASCII character. The maximum number of delimiters is 15, including built-in delimiters.</p>
</td></tr><tr>
<td colspan="1">
<p>/? </p>
</td>
<td colspan="1">
<p>Displays help at the command prompt.</p>
</td></tr></table>
</content></div><h2 class="heading">Remarks</h2><div id="sectionSection2" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<ul xmlns=""><li class="unordered">
The <b>Setx</b> command is similar to the UNIX utility SETENV.<br><br>
</li><li class="unordered">
<b>Setx</b> provides the only command-line or programmatic way to directly and permanently set system environment values. System environment variables are manually configurable through <b>Control Panel</b> or through a registry editor. The <b>set</b> command, which is internal to the command interpreter (Cmd.exe), sets user environment variables for the current console window only. <br><br>
</li><li class="unordered">
You can use the <b>setx</b> command to set values for user and system environment variables from one of three sources (modes): Command Line Mode, Registry Mode, or File Mode.<br><br>
</li><li class="unordered">
<b>Setx</b> writes variables to the master environment in the registry. Variables set with <b>setx</b> variables are available in future command windows only, not in the current command window.<br><br>
</li><li class="unordered">
<b>HKEY_CURRENT_USER</b> and <b>HKEY_LOCAL_MACHINE</b> are the only supported hives. REG_DWORD, REG_EXPAND_SZ, REG_SZ, and REG_MULTI_SZ are the valid <b>RegKey</b> data types.<br><br>
</li><li class="unordered">
When you gain access to <b>REG_MULTI_SZ</b> values in the registry, only the first item is extracted and used.<br><br>
</li><li class="unordered">
You cannot use the <b>setx</b> command to remove values that have been added to the local or system environments. You can use <b>set</b> with a variable name and no value to remove a corresponding value from the local environment.<br><br>
</li><li class="unordered">
REG_DWORD registry values are extracted and used in hexadecimal mode.<br><br>
</li><li class="unordered">
File mode supports the parsing of carriage return and line feed (CRLF) text files only.<br><br>
</li></ul>
</content></div><a name="BKMK_examples"></a><a name="ef37482f-f8a8-4765-951a-2518faac3f44#BKMK_examples"></a><h2 class="heading">Examples</h2><div id="sectionSection3" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns="">To set the MACHINE environment variable in the local environment to the value Brand1, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>setx MACHINE Brand1</pre></td></tr></table></span></div>

<p xmlns="">To set the MACHINE environment variable in the system environment to the value Brand1 Computer, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>setx MACHINE "Brand1 Computer" /m</pre></td></tr></table></span></div>

<p xmlns="">To set the MYPATH environment variable in the local environment to use the search path defined in the PATH environment variable, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>setx MYPATH %PATH%</pre></td></tr></table></span></div>

<p xmlns="">To set the MYPATH environment variable in the local environment to use the search path defined in the PATH environment variable after replacing <b>~</b> with <b>%</b>, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>setx MYPATH ~PATH~ </pre></td></tr></table></span></div>

<p xmlns="">To set the MACHINE environment variable in the local environment to Brand1 on a remote computer named Computer1, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>setx /s computer1 /u maindom\hiropln /p p@ssW23 MACHINE Brand1</pre></td></tr></table></span></div>

<p xmlns="">To set the MYPATH environment variable in the local environment to use the search path defined in the PATH environment variable on a remote computer named Computer1, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>setx /s computer1 /u maindom\hiropln /p p@ssW23 MYPATH %PATH%</pre></td></tr></table></span></div>

<p xmlns="">To set the TZONE environment variable in the local environment to the value found in the <b>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\TimeZoneInformation\StandardName</b> registry key, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>setx TZONE /k HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\TimeZoneInformation\StandardName </pre></td></tr></table></span></div>

<p xmlns="">To set the TZONE environment variable in the local environment of a remote computer named Computer1 to the value found in the <b>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\TimeZoneInformation\StandardName</b> registry key, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>setx /s computer1 /u maindom\hiropln /p p@ssW23 TZONE /k HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\TimeZoneInformation\StandardName </pre></td></tr></table></span></div>

<p xmlns="">To set the BUILD environment variable in the system environment to the value found in the <b>HKEY_LOCAL_MACHINE\Software\Microsoft\WindowsNT\CurrentVersion\CurrentBuildNumber</b> registry key, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>setx BUILD /k "HKEY_LOCAL_MACHINE\Software\Microsoft\WindowsNT\CurrentVersion\CurrentBuildNumber" /m</pre></td></tr></table></span></div>

<p xmlns="">To set the BUILD environment variable in the system environment of a remote computer named Computer1 to the value found in the <b>HKEY_LOCAL_MACHINE\Software\Microsoft\WindowsNT\CurrentVersion\CurrentBuildNumber</b> registry key, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>setx /s computer1 /u maindom\hiropln /p p@ssW23  BUILD /k "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\CurrentBuildNumber" /m</pre></td></tr></table></span></div>

<p xmlns="">To display the contents of a file named Ipconfig.out, along with the contents' corresponding coordinates, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>setx /f ipconfig.out /x</pre></td></tr></table></span></div>

<p xmlns="">To set the IPADDR environment variable in the local environment to the value found at the coordinate 5,11 in the file Ipconfig.out, type: </p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>setx IPADDR /f ipconfig.out /a 5,11</pre></td></tr></table></span></div>

<p xmlns="">To set the OCTET1 environment variable in the local environment to the value found at the coordinate 5,3 in the file Ipconfig.out with delimiters <b>"#$*."</b>, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>setx OCTET1 /f ipconfig.out /a 5,3 /d "#$*." </pre></td></tr></table></span></div>

<p xmlns="">To set the IPGATEWAY environment variable in the local environment to the value found at the coordinate 0,7 with respect to the coordinate of "Gateway" in the file Ipconfig.out, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>setx IPGATEWAY /f ipconfig.out /r 0,7 Gateway </pre></td></tr></table></span></div>

<p xmlns="">To display the contents of a file named Ipconfig.out — along with the contents' corresponding coordinates — on a computer named Computer1, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>setx /s computer1 /u maindom\hiropln /p p@ssW23 /f ipconfig.out /x </pre></td></tr></table></span></div>
</content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"></content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<h4 class="subHeading" xmlns="">Additional references</h4><div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns=""><a href="338c0381-ad63-4a4c-bd2c-42c7a93821fe.htm">Command-Line Syntax Key</a></p>
</content></div>
</sections></div>
</sections></div><!--[if gte IE 5]>
			<tool:tip element="languageFilterToolTip" avoidmouse="false"/>
		<![endif]--></div><div id="footer"><hr><p></div></div></body></html>