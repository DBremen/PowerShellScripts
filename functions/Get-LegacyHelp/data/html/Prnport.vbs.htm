<html dir="LTR" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:tool="http://www.microsoft.com/tooltip"><head><meta http-equiv="Content-Type" content="text/html; CHARSET=Windows-1252"><meta name="save" content="history"><title>Prnport.vbs</title><link rel="stylesheet" type="text/css" href="../local/Classic.css"><script src="../local/script.js"></script></head><body><div><input type="hidden" id="userDataCache" class="userDataStyle"><input type="hidden" id="hiddenScrollOffset"></div><img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif"><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif"><img id="collapseImage" style="display:none; height:0; width:0;" src="../local/collapse.gif"><img id="expandImage" style="display:none; height:0; width:0;" src="../local/exp.gif"><img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif"><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif"><div id="header"><table width="100%" id="topTable"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText"></span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Prnport.vbs</span></td></tr><tr id="headerTableRow3"><td></td></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p>Applies To: Windows Vista,Windows Server 2008</p>
<p>Creates, deletes, and lists standard TCP/IP printer ports, in addition to displaying and changing port configuration.</p>

<p>For examples of how this command can be used, see <a href="#BKMK_examples">Examples</a>.</p>
<h2 class="heading">Syntax</h2><div id="sectionSection0" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>Cscript prnport {-a | -d | -l | -g | -t | -?} [-r &lt;PortName&gt;] <br>[-s &lt;ServerName&gt;] [-u &lt;UserName&gt;] [-w &lt;Password&gt;] [-o {raw | lpr}] <br>[-h &lt;HostAddress&gt;] [-q &lt;QueueName&gt;] [-n &lt;PortNumber&gt;] -m{e | d} <br>[-i &lt;SNMPIndex&gt;] [-y &lt;CommunityName&gt;] -2{e | -d}</pre></td></tr></table></span></div>
</content></div><h2 class="heading">Parameters</h2><div id="sectionSection1" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<h3 class="subHeading" xmlns=""></h3><table xmlns=""><tr>
<th colspan="1">
Parameter
</th>
<th colspan="1">
Description
</th></tr><tr>
<td colspan="1">
<p>-a</p>
</td>
<td colspan="1">
<p>Creates a standard TCP/IP printer port.</p>
</td></tr><tr>
<td colspan="1">
<p>-d</p>
</td>
<td colspan="1">
<p>Deletes a standard TCP/IP printer port.</p>
</td></tr><tr>
<td colspan="1">
<p>-l</p>
</td>
<td colspan="1">
<p>Lists all standard TCP/IP printer ports on the computer specified with the <b>-s</b> parameter.</p>
</td></tr><tr>
<td colspan="1">
<p>-g </p>
</td>
<td colspan="1">
<p>Displays the configuration of a standard TCP/IP printer port.</p>
</td></tr><tr>
<td colspan="1">
<p>-t </p>
</td>
<td colspan="1">
<p>Configures the port settings for a standard TCP/IP printer port.</p>
</td></tr><tr>
<td colspan="1">
<p>-r &lt;PortName&gt;</p>
</td>
<td colspan="1">
<p>Specifies the port to which the printer is connected. </p>
</td></tr><tr>
<td colspan="1">
<p>-s &lt;ServerName&gt;</p>
</td>
<td colspan="1">
<p>Specifies the name of the remote computer that hosts the printer that you want to manage. If you do not specify a computer, the local computer is used.</p>
</td></tr><tr>
<td colspan="1">
<p>-u &lt;UserName&gt; -w &lt;Password&gt;</p>
</td>
<td colspan="1">
<p>Specifies an account with permissions to connect to the computer that hosts the printer that you want to manage. All members of the target computer's local Administrators group have these permissions, but the permissions can also be granted to other users. If you do not specify an account, you must be logged on under an account with these permissions for the command to work. </p>
</td></tr><tr>
<td colspan="1">
<p>-o {raw | lpr}</p>
</td>
<td colspan="1">
<p>Specifies which protocol the port uses: TCP raw or TCP LPR. If you use TCP raw, you can optionally specify the port number by using the <b>-n</b> parameter. The default port number is 9100.</p>
</td></tr><tr>
<td colspan="1">
<p>-h &lt;HostAddress&gt;</p>
</td>
<td colspan="1">
<p>Specifies (by IP address) the printer for which you want to configure the port.</p>
</td></tr><tr>
<td colspan="1">
<p>-q &lt;QueueName&gt;</p>
</td>
<td colspan="1">
<p>Specifies the queue name for a TCP raw port.</p>
</td></tr><tr>
<td colspan="1">
<p>-n &lt;PortNumber&gt; </p>
</td>
<td colspan="1">
<p>Specifies the port number for a TCP raw port. The default port number is 9100.</p>
</td></tr><tr>
<td colspan="1">
<p>-m{e | d}</p>
</td>
<td colspan="1">
<p>Specifies whether SNMP is enabled. The parameter <b>e</b> enables SNMP. The parameter <b>d</b> disables SNMP.</p>
</td></tr><tr>
<td colspan="1">
<p>-i &lt;SNMPIndex</p>
</td>
<td colspan="1">
<p>Specifies the SNMP index, if SNMP is enabled. For more information, see RFC 1759 at the RFC Editor Web site (http://go.microsoft.com/fwlink/?LinkId=569).</p>
</td></tr><tr>
<td colspan="1">
<p>-y &lt;CommunityName&gt;</p>
</td>
<td colspan="1">
<p>Specifies the SNMP community name, if SNMP is enabled.</p>
</td></tr><tr>
<td colspan="1">
<p>-2{e | -d}</p>
</td>
<td colspan="1">
<p>Specifies whether double spools (also known as respooling) are enabled for TCP LPR ports. Double spools are necessary because TCP LPR must include an accurate byte count in the control file that is sent to the printer, but the protocol cannot get the count from the local print provider. Therefore, when a file is spooled to a TCP LPR print queue, it is also spooled as a temporary file in the system32 directory. TCP LPR determines the size of the temporary file and sends the size to the server running LPD. The parameter <b>e</b> enables double spools. The parameter <b>d</b> disables double spools.</p>
</td></tr><tr>
<td colspan="1">
<p>/? </p>
</td>
<td colspan="1">
<p>Displays help at the command prompt.</p>
</td></tr></table>
</content></div><h2 class="heading">Remarks</h2><div id="sectionSection2" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<ul xmlns=""><li class="unordered">
The <b>Prnport.vbs</b> command is a Visual Basic script located in the %WINDIR%\System32\Printing_Admin_Scripts\&lt;language&gt; directory. To use this command, at a command prompt, type <b>Cscript</b> followed by the full path to the Prnport.vbs file, or change directories to the appropriate folder. For example:<br><br>

<div class="code"><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>Cscript %WINDIR%\System32\Printing_Admin_Scripts\en-US\Prnport.vbs</pre></td></tr></table></span></div>
</li><li class="unordered">
If the information that you supply contains spaces, use quotation marks around the text (for example, <code>"Computer Name"</code>).<br><br>
</li><li class="unordered">
The TCP raw protocol is a higher performance protocol on Windows than the LPR protocol.<br><br>
</li></ul>
</content></div><a name="BKMK_examples"></a><a name="6a0ec638-a21e-4a34-be5c-bd0f7ca89ffe#BKMK_examples"></a><h2 class="heading">Examples</h2><div id="sectionSection3" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns="">To display all standard TCP/IP printing ports on the server \\Server1, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>Cscript Prnport.vbs -l -s Server1</pre></td></tr></table></span></div>

<p xmlns="">To delete the standard TCP/IP printing port on the server \\Server1 that connects to a network printer at 10.2.3.4, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>Cscript Prnport.vbs -d -s Server1 -r IP_10.2.3.4</pre></td></tr></table></span></div>

<p xmlns="">To add a standard TCP/IP printing port on the server \\Server1 that connects to a network printer at 10.2.3.4 and uses the TCP raw protocol on port 9100, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>Cscript Prnport.vbs -a -s Server1 -r IP_10.2.3.4 -h 10.2.3.4 -o raw -n 9100</pre></td></tr></table></span></div>

<p xmlns="">To enable SNMP, specify the "public" community name and set the SNMP index to 1 on a network printer at 10.2.3.4 shared by the server \\Server1, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>Cscript Prnport.vbs -t -s Server1 -r IP_10.2.3.4 -me -y public -i 1 -n 9100</pre></td></tr></table></span></div>

<p xmlns="">To add a standard TCP/IP printing port on the local computer that connects to a network printer at 10.2.3.4 and automatically get the device settings from the printer, type:</p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>Cscript Prnport.vbs -a -r IP_10.2.3.4 -h 10.2.3.4</pre></td></tr></table></span></div>
</content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"></content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<h4 class="subHeading" xmlns="">Additional references</h4><div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns=""><a href="338c0381-ad63-4a4c-bd2c-42c7a93821fe.htm">Command-Line Syntax Key</a></p>

<p xmlns=""><a href="88d8fa87-6fa8-4774-9294-080b0157ea8d.htm">Print Command Reference</a></p>
</content></div>
</sections></div>
</sections></div><!--[if gte IE 5]>
			<tool:tip element="languageFilterToolTip" avoidmouse="false"/>
		<![endif]--></div><div id="footer"><hr><p></div></div></body></html>