<html dir="LTR" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:tool="http://www.microsoft.com/tooltip"><head><meta http-equiv="Content-Type" content="text/html; CHARSET=Windows-1252"><meta name="save" content="history"><title>Call</title><link rel="stylesheet" type="text/css" href="../local/Classic.css"><script src="../local/script.js"></script></head><body><div><input type="hidden" id="userDataCache" class="userDataStyle"><input type="hidden" id="hiddenScrollOffset"></div><img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif"><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif"><img id="collapseImage" style="display:none; height:0; width:0;" src="../local/collapse.gif"><img id="expandImage" style="display:none; height:0; width:0;" src="../local/exp.gif"><img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif"><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif"><div id="header"><table width="100%" id="topTable"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText"></span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Call</span></td></tr><tr id="headerTableRow3"><td></td></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p>Applies To: Windows Server 2008,Windows Vista</p>
<p>Calls one batch program from another without stopping the parent batch program. The <b>call</b> command accepts labels as the target of the call. </p>

<div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="../local/note.gif">Note </th></tr><tr><td>
<b>Call</b> has no effect at the command prompt when it is used outside of a script or batch file. <p>
</td></tr></table><p></div>

<p>For examples of how to use this command, see <a href="#BKMK_examples">Examples</a>.</p>
<h2 class="heading">Syntax</h2><div id="sectionSection0" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>call [Drive:][Path]&lt;FileName&gt; [&lt;BatchParameters&gt;] [:&lt;Label&gt; [&lt;Arguments&gt;]]</pre></td></tr></table></span></div>
</content></div><h2 class="heading">Parameters</h2><div id="sectionSection1" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<h3 class="subHeading" xmlns=""></h3><table xmlns=""><tr>
<th colspan="1">
Parameter
</th>
<th colspan="1">
Description
</th></tr><tr>
<td colspan="1">
<p>[&lt;Drive&gt;:][&lt;Path&gt;]&lt;FileName&gt;</p>
</td>
<td colspan="1">
<p>Specifies the location and name of the batch program that you want to call. The <i>FileName</i> parameter is required, and it must have a .bat or .cmd extension.</p>
</td></tr><tr>
<td colspan="1">
<p> &lt;BatchParameters&gt; </p>
</td>
<td colspan="1">
<p>Specifies any command-line information required by the batch program.</p>
</td></tr><tr>
<td colspan="1">
<p> :&lt;Label&gt; </p>
</td>
<td colspan="1">
<p>Specifies the label that you want a batch program control to jump to. </p>
</td></tr><tr>
<td colspan="1">
<p> &lt;Arguments&gt; </p>
</td>
<td colspan="1">
<p>Specifies the command-line information to be passed to the new instance of the batch program, beginning at <i>:Label.</i></p>
</td></tr><tr>
<td colspan="1">
<p> /? </p>
</td>
<td colspan="1">
<p>Displays help at the command prompt.</p>
</td></tr></table>
</content></div><h2 class="heading">Batch parameters</h2><div id="sectionSection2" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns="">The batch script argument references (<b>%0</b>, <b>%1</b>, ...) are listed in the following tables.</p>

<p xmlns=""><b>%*</b> in a batch script refers to all the arguments (for example, <b>%1</b>, <b>%2</b>, <b>%3</b>...)</p>

<p xmlns="">You can use the following optional syntaxes as substitutions for batch parameters (<b>%n</b>):     </p>

<h3 class="subHeading" xmlns=""></h3><table xmlns=""><tr>
<th colspan="1">
Batch Parameter
</th>
<th colspan="1">
Description
</th></tr><tr>
<td colspan="1">
<p>%~1</p>
</td>
<td colspan="1">
<p>Expands <b>%1</b> and removes surrounding quotation marks (" ").</p>
</td></tr><tr>
<td colspan="1">
<p>%~f1</p>
</td>
<td colspan="1">
<p>Expands <b>%1</b> to a fully qualified path.</p>
</td></tr><tr>
<td colspan="1">
<p>%~d1 </p>
</td>
<td colspan="1">
<p>Expands <b>%1</b> to a drive letter only.</p>
</td></tr><tr>
<td colspan="1">
<p>%~p1</p>
</td>
<td colspan="1">
<p>Expands <b>%1</b> to a path only.</p>
</td></tr><tr>
<td colspan="1">
<p>%~n1 </p>
</td>
<td colspan="1">
<p>Expands <b>%1</b> to a file name only.</p>
</td></tr><tr>
<td colspan="1">
<p>%~x1 </p>
</td>
<td colspan="1">
<p>Expands <b>%1</b> to a file name extension only.</p>
</td></tr><tr>
<td colspan="1">
<p>%~s1 </p>
</td>
<td colspan="1">
<p>Expands <b>%1</b> to a fully qualified path that contains short names only.</p>
</td></tr><tr>
<td colspan="1">
<p>%~a1 </p>
</td>
<td colspan="1">
<p>Expands <b>%1</b> to the file attributes.</p>
</td></tr><tr>
<td colspan="1">
<p>%~t1 </p>
</td>
<td colspan="1">
<p>Expands <b>%1</b> to the date and time of file.</p>
</td></tr><tr>
<td colspan="1">
<p>%~z1 </p>
</td>
<td colspan="1">
<p>Expands <b>%1</b> to the size of the file.</p>
</td></tr><tr>
<td colspan="1">
<p>%~$PATH:1 </p>
</td>
<td colspan="1">
<p>Searches the directories listed in the PATH environment variable, and expands <b>%1</b> to the fully qualified name of the first directory found. If the environment variable name is not defined or the file is not found by the search, then this modifier expands to the empty string.</p>
</td></tr></table>

<p xmlns="">The following table shows how you can combine modifiers with the batch parameters for compound results:</p>

<h3 class="subHeading" xmlns=""></h3><table xmlns=""><tr>
<th colspan="1">
Batch Parameter with Modifier
</th>
<th colspan="1">
Description
</th></tr><tr>
<td colspan="1">
<p>%~dp1</p>
</td>
<td colspan="1">
<p>Expands <b>%1</b> to a drive letter and path only.</p>
</td></tr><tr>
<td colspan="1">
<p>%~nx1 </p>
</td>
<td colspan="1">
<p>Expands <b>%1</b> to a file name and extension only.</p>
</td></tr><tr>
<td colspan="1">
<p>%~dp$PATH:1</p>
</td>
<td colspan="1">
<p>Searches the directories listed in the PATH environment variable for <b>%1</b>, and then expands to the drive letter and path of the first directory found.</p>
</td></tr><tr>
<td colspan="1">
<p>%~ftza1 </p>
</td>
<td colspan="1">
<p>Expands <b>%1</b> to display output similar to the <b>dir</b> command.</p>
</td></tr></table>

<p xmlns="">In the above examples, <b>%1</b> and PATH can be replaced by other valid values. The <b>%~</b> syntax is terminated by a valid argument number. The <b>%~</b> modifiers cannot be used with <b>%*</b>.</p>
</content></div><h2 class="heading">Remarks</h2><div id="sectionSection3" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<ul xmlns=""><li class="unordered">
Using batch parameters <br><br>

Batch parameters can contain any information that you can pass to a batch program, including command-line options, file names, the batch parameters <b>%0</b> through <b>%9</b>, and variables (for example, <b>%baud%</b>).  <br><br>
</li><li class="unordered">
Using the <i>Label</i> parameter<br><br>

By using <b>call </b>with the <i>Label</i> parameter, you create a new batch file context and pass control to the statement after the specified label. The first time the end of the batch file is encountered (that is, after jumping to the label), control returns to the statement after the <b>call </b>statement. The second time the end of the batch file is encountered, the batch script is exited. <br><br>
</li><li class="unordered">
Using pipes and redirection symbols<br><br>

Do not use pipes (<b>|</b>) and redirection symbols (<b>&lt;</b> or <b>&gt;</b>) with <b>call</b>.<br><br>
</li><li class="unordered">
Making a recursive call <br><br>

You can create a batch program that calls itself. However, you must provide an exit condition. Otherwise, the parent and child batch programs can loop endlessly.<br><br>
</li><li class="unordered">
Working with command extensions <br><br>

If command extensions are enabled, <b>call</b> accepts <i>Label</i> as the target of the call. The correct syntax is as follows:<br><br>

<code>call :&lt;Label&gt; &lt;Arguments&gt;</code><br><br>
</li></ul>
</content></div><a name="BKMK_examples"></a><a name="d34a41dc-e6c7-4467-bf6a-15cec704833e#BKMK_examples"></a><h2 class="heading">Examples</h2><div id="sectionSection4" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns="">To run the Checknew.bat program from another batch program, type the following command in the parent batch program: </p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>call checknew</pre></td></tr></table></span></div>

<p xmlns="">If the parent batch program accepts two batch parameters and you want it to pass those parameters to Checknew.bat, type the following command in the parent batch program: </p>

<div class="code" xmlns=""><span codelanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif">Copy Code</span></th></tr><tr><td colspan="2"><pre>call checknew %1 %2</pre></td></tr></table></span></div>
</content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"></content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<h4 class="subHeading" xmlns="">Additional references</h4><div class="subSection" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
<p xmlns=""><a href="338c0381-ad63-4a4c-bd2c-42c7a93821fe.htm">Command-Line Syntax Key</a></p>
</content></div>
</sections></div>
</sections></div><!--[if gte IE 5]>
			<tool:tip element="languageFilterToolTip" avoidmouse="false"/>
		<![endif]--></div><div id="footer"><hr><p></div></div></body></html>